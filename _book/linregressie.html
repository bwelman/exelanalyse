<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Hoofdstuk 6 Samenhang en lineaire regressie | Excel Data Analyse</title>
<meta name="author" content="Ben Welman">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.7.10/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.4/tabs.js"></script><script src="libs/bs3compat-0.2.4/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><meta name="description" content="Cursus data analyse met Excel">
<meta name="keywords" content="tutorial, cursus, studieboek, excel, data analyse, gegevensanalyse, statistiek, tijdreeksen, voorspellingen, prognoses, ETS">
<meta name="robots" content="index,follow">
<meta name="twitter:title" content="Cursus data analyse met Excel">
<meta name="twitter:description" content="Cursus data analyse met Excel">
<meta name="twitter:url" content="https://excelanalyse.netlify.app/">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@benwem">
<meta name="twitter:site" content="@benwem">
<meta property="og:title" content="Cursus data analyse met Excel">
<meta property="og:description" content="Cursus data analyse met Excel">
<meta property="og:url" content="https://excelanalyse.netlify.app/">
<meta property="og:type" content="book">
<meta property="og:locale" content="nl_NL">
<meta property="article:author" content="Ben Welman">
<script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet">
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script><script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script><script src="libs/viz-1.8.2/viz.js"></script><link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">
<script src="libs/grViz-binding-1.0.6.1/grViz.js"></script><script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-1284000-9', 'auto');
      ga('send', 'pageview');

    </script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS --><link rel="stylesheet" href="css/textbook.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Excel Data Analyse</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welkom</a></li>
<li><a class="" href="voorwoord.html">Voorwoord</a></li>
<li><a class="" href="importdata.html"><span class="header-section-number">1</span> Importeren van data</a></li>
<li><a class="" href="data.html"><span class="header-section-number">2</span> Data</a></li>
<li><a class="" href="beschrijvend.html"><span class="header-section-number">3</span> Beschrijvende statistiek</a></li>
<li><a class="" href="grafieken.html"><span class="header-section-number">4</span> Grafieken</a></li>
<li><a class="" href="eda.html"><span class="header-section-number">5</span> Exploratieve Data Analyse (EDA)</a></li>
<li><a class="active" href="linregressie.html"><span class="header-section-number">6</span> Samenhang en lineaire regressie</a></li>
<li><a class="" href="timeseries.html"><span class="header-section-number">7</span> Tijdreeksen</a></li>
<li><a class="" href="prognoses.html"><span class="header-section-number">8</span> Prognoses</a></li>
<li><a class="" href="cases.html"><span class="header-section-number">9</span> Cases</a></li>
<li class="book-part">Bijlagen</li>
<li><a class="" href="app-toolpak.html"><span class="header-section-number">A</span> Addin Gegevensanalyse</a></li>
<li><a class="" href="app-query-options.html"><span class="header-section-number">B</span> Power Query opties</a></li>
<li><a class="" href="app-excel-trendlijnen.html"><span class="header-section-number">C</span> Excel Trendlijnen</a></li>
<li><a class="" href="app-voorspellingenblad.html"><span class="header-section-number">D</span> Voorspellingenblad</a></li>
<li><a class="" href="app-aselect.html"><span class="header-section-number">E</span> Aselecte getallen</a></li>
<li><a class="" href="referenties.html">Referenties</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="linregressie" class="section level1" number="6">
<h1>
<span class="header-section-number">Hoofdstuk 6</span> Samenhang en lineaire regressie<a class="anchor" aria-label="anchor" href="#linregressie"><i class="fas fa-link"></i></a>
</h1>
<div class="chapterintro">
<p>Voor het nemen van beslissingen is het van belang om te weten of er samenhang tussen variabelen bestaat. Ook kan het zijn dat je de waarde van een variabele wilt schatten op basis van de waarde van andere variabelen. Onderzoek naar een mogelijk verband tussen variabelen is dan nodig. Is er een verband dan kan een model voor het verband worden opgesteld.</p>
</div>
<p>De variabele waarvan je de waarde wilt schatten en die afhangt van de waarde van een andere variabele wordt heeft benamingen als <em>afhankelijke variabele</em>, <em>verklaarde variabele</em> of <em>respons variabele</em>. En de variabelen waarvan deze afhangt worden de <em>onafhankelijke variabelen</em>, of <em>verklarende variabelen</em> genoemd. De techniek naar mogelijke verbanden wordt ook wel <em>regressie-analyse</em> genoemd.</p>
<p><span class="math inline">\(Onafhankelijke (verklarende) variabele \rightarrow Afhankelijke (verklaarde) variabele\)</span></p>
<div id="samenhang" class="section level2" number="6.1">
<h2>
<span class="header-section-number">6.1</span> Samenhang<a class="anchor" aria-label="anchor" href="#samenhang"><i class="fas fa-link"></i></a>
</h2>
<p>De waarden van een variabele kunnen samenhangen met de waarden van een andere variabele. Zo zal meestal de benzineprijs stijgen wanneer de prijs van een vat ruwe olie stijgt. De variabelen benzineprijs en olieprijs vertonen dan een positieve samenhang. Het omgekeerde kan ook, wanneer bijvoorbeeld de werkloosheid stijgt dan dalen de consumentenuitgaven. De variabelen werkloosheidspercentage en consumentenuitgaven vertonen een negatieve samenhang.</p>
<p>Of er een mogelijk verband tussen numerieke variabelen is kun je onderzoeken</p>
<ul>
<li>door ze in een spreidingsdiagram tegen elkaar uit te zetten en dan te kijken of er een patroon zichtbaar is.</li>
<li>door de covariantie of correlatiecoëfficiënt te berekenen.</li>
</ul>
<p>wanneer er een verband tussen twee variabelen is, dan zal ook de variantie van de variabelen samenhang vertonen. Er is dan sprake van <em>covariantie</em> (gedeelde variantie). vandaar dat variabelen die aan elkaar gerelateerd zijn en dus een deel van hun variantie delen, ook wel <em>covariaten</em> genoemd worden. Een maatstaf om de samenhang tussen twee variabelen in uit te drukken is de <em>covariantie</em>, welke aangeeft of en hoeveel de waarden van de ene variabele toe- dan wel afnemen bij toenemende waarden van de andere variabele.</p>
<!-- De covariatie is het gemiddelde van de produkten van de deviaties (afwijkingen van het gemiddelde) voor ieder gegevenspaar. -->
<p>Het lastige is echter dat variantie afhangt van de meetschaal. Stap je bijvoorbeeld bij het meten van de lengte over van meters naar centimeters, dan worden de meetwaarden zelf 100 keer zo groot, maar de variantie wordt 10.000 keer zo groot. De variantie is dus gevoelig voor veranderingen in de schaal. Daarom kun je door simpelweg naar de covariantie te kijken niet zeggen of de variabelen veel of weinig van hun variantie delen. De covariantie is hierdoor een minder bruikbaar getal en zal dan ook verder bij de analyses niet bekeken worden.</p>
<p>Een betere maat voor de samenhang is de <em>Pearson correlatiecoëfficiënt</em> welke berekend wordt door de covariantie te delen door het produkt van de standaarddeviaties van beide variabelen. Deze is onafhankelijk van de meetschaal. Deze correlatiecoëfficiënt wordt meestal weergegeven met <span class="math inline">\(r\)</span> en de waarde loopt van -1 tot +1:</p>
<ul>
<li>
<span class="math inline">\(-1\)</span> bij een volledig negatieve samenhang.</li>
<li>
<span class="math inline">\(0\)</span> bij geen samenhang</li>
<li>
<span class="math inline">\(+1\)</span> bij een volledig positieve samenhang</li>
</ul>
<p>Met de correlatiecoëfficiënt kun je dus zowel de sterkte van de correlatie aangeven als de richting (positief of negatief).</p>
<p>Voor alleen de sterkte van de correlatie wordt meestal gewerkt met het kwadraat van de correlatiecoëfficiënt, aangeduid met <span class="math inline">\(R^2\)</span>. De benaming hiervoor is <em>R-kwadraat</em> of ook wel <em>determinatiecoefficient</em>. De waarde ervan loopt van 0 tot 1. Hoe dichter bij 1, hoe sterker het verband.</p>
<p>Deze R-kwadraat geeft tevens aan welk deel (of percentage bij vermenigvuldiging met 100) van de variantie de variabelen met elkaar delen. Of met andere woorden, welke deel van de variantie in de ene variabele verklaard wordt door de variantie in de andere variabele. Dit wordt de <em>verklaarde variantie</em> genoemd.</p>
<p><strong>Excel formules</strong></p>
<ul>
<li>Covariantie populatie: <code>COVARIANTIE.P()</code>
</li>
<li>Covariantie steekproef: <code>COVARIANTIE.S()</code>
</li>
<li>Pearson correlatiecoëfficiënt: <code>PEARSON()</code>
</li>
<li>R-kwadraat: <code>R-KWADRAAT()</code>
</li>
</ul>
</div>
<div id="lineair-verband" class="section level2" number="6.2">
<h2>
<span class="header-section-number">6.2</span> Lineair verband<a class="anchor" aria-label="anchor" href="#lineair-verband"><i class="fas fa-link"></i></a>
</h2>
<p>Wiskundig gezien is een verband tussen twee numerieke variabelen lineair wanneer je dat verband grafisch weer kunt geven met een rechte lijn. Bij een niet-lineair verband heb je een gebogen lijn.</p>
<p>Heb je te maken met maar één verklarende variabele dan wordt dat <em>enkelvoudige lineaire regressie</em> genoemd. Zijn er meerdere verklarende variabelen dan heet dat <em>meervoudige lineaire regressie</em>.</p>
<p>Hoewel regressie en correlatie vaak samen gebruikt worden, zijn het twee verschillende begrippen.</p>
<ul>
<li>
<em>Regressie</em> heeft als doel om de soort relatie tussen <span class="math inline">\(y\)</span> en <span class="math inline">\(x\)</span> te bepalen. Bijvoorbeeld <span class="math inline">\(y\)</span> neemt lineair toe als <span class="math inline">\(x\)</span> toeneemt.</li>
<li>
<em>Correlatie</em> meet de sterkte van die relatie. Is die sterk of juist zwak.</li>
</ul>
<div class="{important}">
<p>Regressie en correlatie verklaren de wijzigingen in de afhankelijke variabele, maar niet de oorzaak van deze wijzigingen. Er hoeft dus geen oorzakelijk verband te zijn.</p>
</div>
</div>
<div id="linreg-enkelvoudig" class="section level2" number="6.3">
<h2>
<span class="header-section-number">6.3</span> Enkelvoudige lineaire regressie<a class="anchor" aria-label="anchor" href="#linreg-enkelvoudig"><i class="fas fa-link"></i></a>
</h2>
<p>Het lineaire regressiemodel bevat één verklarende variabele en kun je weergeven met de vergelijking</p>
<p><span class="math inline">\(y = \beta_0 + \beta_1 * x + \epsilon\)</span>, met</p>
<ul>
<li>
<span class="math inline">\(y\)</span> : afhankelijke (respons) variabele</li>
<li>
<span class="math inline">\(x\)</span> : onafhankelijke (verklarende) variabele</li>
<li>
<span class="math inline">\(\beta_0\)</span> : intercept, snijpunt met y-as, de waarde van <span class="math inline">\(y\)</span> voor <span class="math inline">\(x=0\)</span>
</li>
<li>
<span class="math inline">\(\beta_1\)</span> : richtingscoëfficient, de verandering van de waarde van <span class="math inline">\(y\)</span> wanneer de waarde van <span class="math inline">\(x\)</span> met 1 toeneemt.</li>
<li>
<span class="math inline">\(\epsilon\)</span> : foutterm, verschil tussen de echte waarde van <span class="math inline">\(y\)</span> en de geschatte waarde van <span class="math inline">\(y\)</span>. Dit is het deel van de afhankelijke variabele dat niet verklaard kan worden door de onafhankelijke variabele. Wordt ook wel ruis of storing genoemd.</li>
</ul>
<p>Bij lineaire regressie probeer je de beste waarden voor <span class="math inline">\(\beta_0\)</span> en <span class="math inline">\(\beta_1\)</span> te vinden zodat de totale fout van het model zo klein mogelijk wordt.</p>
<p>Als voorbeeld wordt een gesimuleerde dataset met 15 waarnemingen voor <span class="math inline">\(x\)</span> en <span class="math inline">\(y\)</span> gebruikt om een aantal achtergronden uit te leggen.</p>
<div class="inline-table"><table class="table" style="font-size: 14px; width: auto !important; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:sim1-data">Tabel 6.1: </span>Dataset met 15 waarnemingen x en y.
</caption>
<tbody>
<tr>
<td style="text-align:left;">
x
</td>
<td style="text-align:right;">
1,1
</td>
<td style="text-align:right;">
1,5
</td>
<td style="text-align:right;">
2,2
</td>
<td style="text-align:right;">
2,9
</td>
<td style="text-align:right;">
3,1
</td>
<td style="text-align:right;">
3,8
</td>
<td style="text-align:right;">
4,0
</td>
<td style="text-align:right;">
4,9
</td>
<td style="text-align:right;">
6,3
</td>
<td style="text-align:right;">
6,9
</td>
<td style="text-align:right;">
7,8
</td>
<td style="text-align:right;">
8,5
</td>
<td style="text-align:right;">
9,4
</td>
<td style="text-align:right;">
9,0
</td>
<td style="text-align:right;">
9,8
</td>
</tr>
<tr>
<td style="text-align:left;">
y
</td>
<td style="text-align:right;">
4,2
</td>
<td style="text-align:right;">
8,7
</td>
<td style="text-align:right;">
11,4
</td>
<td style="text-align:right;">
7,4
</td>
<td style="text-align:right;">
12,5
</td>
<td style="text-align:right;">
11,2
</td>
<td style="text-align:right;">
14,3
</td>
<td style="text-align:right;">
19,1
</td>
<td style="text-align:right;">
15,8
</td>
<td style="text-align:right;">
20,1
</td>
<td style="text-align:right;">
18,4
</td>
<td style="text-align:right;">
23,5
</td>
<td style="text-align:right;">
22,8
</td>
<td style="text-align:right;">
21,1
</td>
<td style="text-align:right;">
27,0
</td>
</tr>
</tbody>
</table></div>
<p>In figuur <a href="linregressie.html#fig:sim1-basis">6.1</a> kun je zien hoe ze aan elkaar gerelateerd zijn.</p>
<div class="figure" style="text-align: center">
<span id="fig:sim1-basis"></span>
<img src="excelanalyse_files/figure-html/sim1-basis-1.svg" alt="Spreidingsdiagram voor de 15 waarnemingen." width="100%"><p class="caption">
Figuur 6.1: Spreidingsdiagram voor de 15 waarnemingen.
</p>
</div>
<p>De gegevens laten een sterk lineair patroon zien en lenen zich ervoor om het patroon in een lineair model vast te leggen. Wanneer je de waarden voor <span class="math inline">\(\beta_0\)</span> en <span class="math inline">\(\beta_1\)</span> hebt, kun je via de vergelijking van de regressielijn voor elke waarde van <span class="math inline">\(x\)</span> een bijbehorende waarde van <span class="math inline">\(y\)</span> berekenen. Deze voorspelde y-waarden worden ook wel de geschatte waarden genoemd.</p>
<p>De kunst is nu om zodanige waarden voor <span class="math inline">\(\beta_0\)</span> en <span class="math inline">\(\beta_1\)</span> te vinden, zodat de regressielijn zo dicht mogelijk bij de gegevens ligt, dan ligt de voorspelde waarde zo dicht mogelijk bij de echte waarde.</p>
<p>In figuur <a href="linregressie.html#fig:sim1-regressie">6.2</a> is een regressielijn (rood) getekend met daarnaast vertikale afstanden (blauwe lijnstukjes) tussen de echte y-waarde (de zwarte punt) en de voorspelde y-waarde (het punt op de rode lijn.</p>
<div class="figure" style="text-align: center">
<span id="fig:sim1-regressie"></span>
<img src="excelanalyse_files/figure-html/sim1-regressie-1.svg" alt="Spreidingsdiagram nu met regressielijn en afstandslijntjes." width="100%"><p class="caption">
Figuur 6.2: Spreidingsdiagram nu met regressielijn en afstandslijntjes.
</p>
</div>
<p>Voor elk punt is afstand = <span class="math inline">\(y - y_{voorspeld}\)</span>. Dit verschil wordt ook wel <strong>residu</strong> genoemd. En de beste lijn is de lijn waarvoor de som van de kwadratische afstanden zo klein mogelijk is. Deze methode heet ook wel de <strong>kleinste kwadraten methode</strong>. Hoe je dit precies berekend is in dit kader niet van belang. Excel gebruikt deze methode ook.</p>
<p>Je kunt in Excel op een aantal manieren een lineaire regressie uitvoeren.</p>
<div id="methode---formules" class="section level3" number="6.3.1">
<h3>
<span class="header-section-number">6.3.1</span> Methode - Formules<a class="anchor" aria-label="anchor" href="#methode---formules"><i class="fas fa-link"></i></a>
</h3>
<p>De regresiecoëfficienten kun je met de volgende formules bepalen:</p>
<ul>
<li>
<span class="math inline">\(\beta_0\)</span> - met formule <code>SNIJPUNT(y-bekend ; x-bekend)</code>
</li>
<li>
<span class="math inline">\(\beta_1\)</span> - met formule <code>RICHTING(y-bekend ; x-bekend)</code>
</li>
</ul>
<p>Toegepast op het voorbeeld levert dit op: <code>SNIJPUNT=4,7096</code> en <code>RICHTING= 2,0549</code>. De regressielijn wordt dan <span class="math inline">\(y = 4,7096 + 2,0549 * x\)</span>.</p>
<p>Verdere analyses, zoals het berekenen van de residuen, zul je zelf moeten samenstellen met behulp van deze waarden.</p>
</div>
<div id="methode---spreidingsdiagram-met-trendlijn" class="section level3" number="6.3.2">
<h3>
<span class="header-section-number">6.3.2</span> Methode - Spreidingsdiagram met trendlijn<a class="anchor" aria-label="anchor" href="#methode---spreidingsdiagram-met-trendlijn"><i class="fas fa-link"></i></a>
</h3>
<p>Bij het maken van een spreidingsdiagram kun je bij de opmaak aangeven dat de vergelijking van de lijn in de grafiek moet worden weergegeven. Je krijgt dan de gevonden waarden voor <span class="math inline">\(\beta_0\)</span> en <span class="math inline">\(\beta_1\)</span> te zien. Voor visualisatie is dit wel nuttig, maar verder kun je hier niets mee doen.</p>
<div class="figure" style="text-align: center">
<span id="fig:sim1-spreiding"></span>
<img src="images/linregressie/sim1-spreiding.png" alt="Spreidingsdiagram in Excel en vergelijking lijn." width="100%"><p class="caption">
Figuur 6.3: Spreidingsdiagram in Excel en vergelijking lijn.
</p>
</div>
</div>
<div id="methode---gegevensanalyse" class="section level3" number="6.3.3">
<h3>
<span class="header-section-number">6.3.3</span> Methode - Gegevensanalyse<a class="anchor" aria-label="anchor" href="#methode---gegevensanalyse"><i class="fas fa-link"></i></a>
</h3>
<p>Met deze methode kun je een uitvoerige analyse maken. Kies <em>Gegevens &gt; Gegevensanalyse &gt; Regressie</em>. Je krijgt dan het volgende dialoogscherm:</p>
<div class="figure" style="text-align: center">
<span id="fig:toolpak-regressie"></span>
<img src="images/linregressie/toolpak-regressie.png" alt="Dialoogscherm regressie." width="70%"><p class="caption">
Figuur 6.4: Dialoogscherm regressie.
</p>
</div>
<ul>
<li>
<em>Invoerbereik y</em> - Specificeer het gebied voor de y-waarden, inclusief eventuele koptekst.</li>
<li>
<em>Invoerbereik x</em> - Specificeer het gebied voor de x-waarden, inclusief eventuele koptekst.</li>
<li>
<em>Labels</em> - Selecteer deze wanneer de invoerbereiken kopteksten bevatten.</li>
<li>
<em>Betrouwbaarheidsniveau</em> - Deze staat standaard op 95% en kun je in de meeste gevallen zo laten. Desgewenst kan het via deze keuzeknop gewijzigd worden in een ander percentage.</li>
<li>
<em>Uitvoeropties</em> - Geef aan waar de uitvoer moet komen.</li>
<li>
<em>Storingen</em> - Storingen zijn de residuen. Voor elke waarneming wordt de storing bepaald.</li>
<li>
<em>Standaardstoringen</em> - De standaardwaarde van elke storing.</li>
<li>
<em>Grafiek voor storingen</em> - Spreidingsdiagram van storing en <span class="math inline">\(x\)</span>.</li>
<li>
<em>Grafiek voor lijnen</em> - Spreidingsdiagram waarin zowel <span class="math inline">\(y\)</span> als <span class="math inline">\(y_{voorspeld}\)</span> uitgezet is tegen <span class="math inline">\(x\)</span>.</li>
</ul>
<p>Na OK verschijnt de uitvoer van de regressie-analyse.</p>
<p>De uitvoer bestaat uit een aantal onderdelen. De belangrijkste daarvan zullen hier besproken worden.</p>
<p><strong>Samenvatting regressie</strong></p>
<div class="figure" style="text-align: center">
<span id="fig:sim1-samenvatting"></span>
<img src="images/linregressie/sim1-samenvatting.png" alt="Samenvatting regressie." width="70%"><p class="caption">
Figuur 6.5: Samenvatting regressie.
</p>
</div>
<ul>
<li>
<em>R-kwadraat</em> - Een belangrijke waarde welke aangeeft hoeveel van de variantie in de afhankelijke variabele verklaard wordt door de variantie in de onafhankelijke variabele(n). Dus in feite hoe goed de regressielijn bij de werkelijke data past. De waarde ligt tussen 0 1n 1. Bij een waarde van 0,7 (70%) heb je al een redelijk goede waarde.</li>
<li>
<em>Aangepaste kleinste kwadraat</em> - Wat conservatiever dan R-kwadraat.</li>
</ul>
<p><strong>Variantie-analyse (ANOVA)</strong></p>
<div class="figure" style="text-align: center">
<span id="fig:sim1-anova"></span>
<img src="images/linregressie/sim1-anova.png" alt="Variantie-analyse regressie." width="100%"><p class="caption">
Figuur 6.6: Variantie-analyse regressie.
</p>
</div>
<p>Bij eenvoudige lineaire regressie is dit niet zo van belang. De waarde van <em>Significantie F</em> moet wel groter dan 0,05 zijn, zoniet onderzoek dan of een andere onafhankelijke variabele geschikter is.</p>
<p><strong>Regressie-coëfficiënten</strong></p>
<div class="figure" style="text-align: center">
<span id="fig:sim1-coefficienten"></span>
<img src="images/linregressie/sim1-coefficienten.png" alt="Coéfficiënten regressielijn." width="100%"><p class="caption">
Figuur 6.7: Coéfficiënten regressielijn.
</p>
</div>
<p>Dit is wel het belangrijkste deel in de uitvoer. Je ziet de reeds eerder genoemde waarden van de coëfficiënten van de regressievergelijking: <span class="math inline">\(y = 4,7096 + 2,0549 * x\)</span>.</p>
<p><strong>Residuen</strong></p>
<p>De residuen zijn het verschil tussen de werkelijke waarde en de voorspelde waarde en zijn eenvoudig uit te rekenen. Zo is voor de 7e waarneming met <span class="math inline">\(x = 4,0\)</span> en <span class="math inline">\(y = 14,3\)</span> de voorspelde waarde <span class="math inline">\(y_{voorspeld} = 4,7096 + 2,0549*4,0 = 12,93\)</span> en dus is het residu <span class="math inline">\(\epsilon = 14,3 - 12,93 = 1,37\)</span>.</p>
<p>Gelukkig hoef je dit niet allemaal handmatig uit te rekenen. <em>Storingen</em> is de term die Excel gebruikt voor <em>Residuen</em>. Wanneer je in het dialoogscherm Gegevensanalyse hebt aangegeven dat “Storingen” en “Grafiek voor storingen” moeten worden weergegeven dan wordt het volgende in de uitvoer getoond.</p>
<div class="figure" style="text-align: center">
<span id="fig:sim1-residu"></span>
<img src="images/linregressie/sim1-residuen.png" alt="Residu Analyse." width="40%"><img src="images/linregressie/sim1-residuplot.png" alt="Residu Analyse." width="40%"><p class="caption">
Figuur 6.8: Residu Analyse.
</p>
</div>
<p>In de grafiek in figuur <a href="linregressie.html#fig:sim1-residu">6.8</a> zijn de residuen (storingen) uitgezet tegen de bijbehorende x-waarde. In het ideale geval zouden alle residuen gelijk aan 0 moeten zijn en de de punten in het residuendiagram op de x-as moeten liggen. De residuen vormen dus de variatie in de data die niet door het regressiemodel verklaard worden. Bij een positief residu wordt de waarde <em>onderschat</em> door het model en bij een negatief residu wordt de waarde <em>overschat</em>.</p>
<div class="important">
<p><strong>Residuen</strong> zijn belangrijk bij het evalueren hoe goed een (lineair) model bij de dataset past. Het diagram met residuen moet altijd goed bestudeerd worden.
Bij een goed model moeten de residuen willekeurig langs de x-as verdeeld zijn en moet het gemiddelde en de som van de residuen bij benadering zo dicht mogelijk bij nul liggen. Is dat niet het geval en is er nog een patroon zichtbaar, dan moet het model aangepast worden. In het hierna volgende voorbeeld wordt dat duidelijk gemaakt.</p>
</div>
</div>
<div id="sim2" class="section level3" number="6.3.4">
<h3>
<span class="header-section-number">6.3.4</span> Voorbeeld Druk-Temperatuur<a class="anchor" aria-label="anchor" href="#sim2"><i class="fas fa-link"></i></a>
</h3>
<p>Bij een bepaald natuurkundig experiment wil men onderzoeken of de druk lineair afhankelijk is van de temperatuur. Daartoe zijn 10 waarnemingen verzameld die te vinden zijn in het bestand <a href="data/sim2.csv">sim2.csv</a>.</p>
<div class="inline-table"><table class="table table-condensed" style="font-size: 14px; width: auto !important; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:sim2-data">Tabel 6.2: </span>Temp-Druk
</caption>
<thead><tr>
<th style="text-align:right;">
temperatuur
</th>
<th style="text-align:right;">
druk
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
18,5
</td>
</tr>
<tr>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
24,9
</td>
</tr>
<tr>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
30,3
</td>
</tr>
<tr>
<td style="text-align:right;">
40
</td>
<td style="text-align:right;">
43,7
</td>
</tr>
<tr>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
80,1
</td>
</tr>
<tr>
<td style="text-align:right;">
60
</td>
<td style="text-align:right;">
118,5
</td>
</tr>
<tr>
<td style="text-align:right;">
70
</td>
<td style="text-align:right;">
169,9
</td>
</tr>
<tr>
<td style="text-align:right;">
80
</td>
<td style="text-align:right;">
228,3
</td>
</tr>
<tr>
<td style="text-align:right;">
90
</td>
<td style="text-align:right;">
302,7
</td>
</tr>
<tr>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
385,1
</td>
</tr>
</tbody>
</table></div>
<p>In figuur <a href="linregressie.html#fig:sim2-spreiding">6.9</a> is de druk tegen de temperatuur uitgezet.</p>
<div class="figure" style="text-align: center">
<span id="fig:sim2-spreiding"></span>
<img src="images/linregressie/sim2-spreiding.png" alt="Spreidingsdiagram in Excel met vergelijking lijn." width="70%"><p class="caption">
Figuur 6.9: Spreidingsdiagram in Excel met vergelijking lijn.
</p>
</div>
<p>Er is een duidelijk positief verband te zien dat redelijk bij een rechte lijn in de buurt komt. Echter in het midden is wel een vorm van een kromming waar te nemen.</p>
<p>Vervolgens wordt een regressie-analyse via Gegevensanalyse uitgevoerd.</p>
<div class="figure" style="text-align: center">
<span id="fig:sim2-samenvatting"></span>
<img src="images/linregressie/sim2-samenvatting.png" alt="Samenvatting regressie." width="70%"><p class="caption">
Figuur 6.10: Samenvatting regressie.
</p>
</div>
<p>Zowel de correlatiecoëfficiënt als R-kwadraat liggen dicht bij 1 en dat is goed.</p>
<div class="figure" style="text-align: center">
<span id="fig:sim2-coefficienten"></span>
<img src="images/linregressie/sim2-coefficienten.png" alt="Coéfficiënten regressielijn." width="100%"><p class="caption">
Figuur 6.11: Coéfficiënten regressielijn.
</p>
</div>
<p>Voor beide coëfficiënten is de p-waarde kleiner dan 0,05 en dus zijn de coëfficiënten significant.</p>
<div class="figure" style="text-align: center">
<span id="fig:sim2-residu"></span>
<img src="images/linregressie/sim2-residuen.png" alt="Residu Analyse." width="40%"><img src="images/linregressie/sim2-residuplot.png" alt="Residu Analyse." width="40%"><p class="caption">
Figuur 6.12: Residu Analyse.
</p>
</div>
<p>Het gemiddelde en de som van de residuen zijn naderhand met een formule berekend en zijn nagenoeg nul, wat ook goed is.</p>
<p>Echter in het diagram van de residuen is te zien dat de waarden niet willekeurig verdeeld zijn en een patroon laten zien dat op een parabool lijkt. Dat betekent dat er misschien een verborgen patroon is dat niet door het lineaire model wordt meegenomen. Vanwege het paraboolkarakter van de residuen ligt het voor de hand om te onderzoeken of het toevoegen van een kwadratische term een beter een resultaat oplevert. Het model zou dan de volgende vorm kunnen hebben:</p>
<p><span class="math inline">\(druk = \beta_0 + \beta_1 * temperatuur + \beta2 * temperatuur^2 + \epsilon\)</span></p>
<p>Het valt buiten het karakter van dit hoofdstuk om deze analyse uit te voeren. Wel kun je in het spreidingsdiagram voor een andere trendlijn dan lineair kiezen. Zo levert de keuze voor een polynoom van de graad 2 het volgende op.</p>
<div class="figure" style="text-align: center">
<span id="fig:sim2-polynoom2"></span>
<img src="images/linregressie/sim2-polynoom2.png" alt="Spreidingsdiagram met een polynoom van de graad 2 als trendlijn." width="70%"><p class="caption">
Figuur 6.13: Spreidingsdiagram met een polynoom van de graad 2 als trendlijn.
</p>
</div>
<p>De R-kwadraat is nu bijna 1.</p>
</div>
</div>
<div id="linreg-meervoudig" class="section level2" number="6.4">
<h2>
<span class="header-section-number">6.4</span> Meervoudige lineaire regressie<a class="anchor" aria-label="anchor" href="#linreg-meervoudig"><i class="fas fa-link"></i></a>
</h2>
<p>Bij een meervoudig lineair regressiemodel zijn er meerdere verklarende variabelen. De algemene vergelijking is</p>
<p><span class="math inline">\(y = \beta_0 + \beta_1 * x_1 + \beta_2 * x_2 + \beta_3 * x_3 + \cdots + \epsilon\)</span>, met</p>
<ul>
<li>
<span class="math inline">\(y\)</span> : afhankelijke (respons) variabele</li>
<li>
<span class="math inline">\(x_1, x_2, x_3, \cdots\)</span> : onafhankelijke (verklarende) variabelen</li>
</ul>
<p>Om het overzichtelijk en niet te ingewikkeld te maken, een voorbeeld met een gefingeerde verzameling economische gegevens. Deze data kun je in Excel importeren via het bestand <a href="data/economiedata.xlsx">economiedata.xlsx</a>.</p>
<div class="figure" style="text-align: center">
<span id="fig:ecdata"></span>
<img src="images/linregressie/ecdata.png" alt="Dataset economische gegevens." width="70%"><p class="caption">
Figuur 6.14: Dataset economische gegevens.
</p>
</div>
<p>Onderzocht gaat worden of <code>Aandelenindex</code> lineair afhankelijk is van zowel <code>Rentepercentage</code> als <code>Werkloosheidspercentage</code>. De variabelen zijn dus:</p>
<ul>
<li>Afhankelijke variabele: <code>Aandelenindex</code>
</li>
<li>Onafhankelijke variabelen: <code>Rentepercentage</code> en <code>Werkloosheidspercentage</code>
</li>
</ul>
<p>Allereerst wordt gekeken of er een relatie is tussen de afhankelijke variabele en elk van de onafhankelijke variabelen afzonderlijk.</p>
<div class="figure" style="text-align: center">
<span id="fig:ecdata-relaties"></span>
<img src="images/linregressie/ecdata-rel1.png" alt="Relaties tussen Aandelenindex en respectievelijk Rentepercentage en Werkloosheidspercentage." width="50%"><img src="images/linregressie/ecdata-rel2.png" alt="Relaties tussen Aandelenindex en respectievelijk Rentepercentage en Werkloosheidspercentage." width="50%"><p class="caption">
Figuur 6.15: Relaties tussen Aandelenindex en respectievelijk Rentepercentage en Werkloosheidspercentage.
</p>
</div>
<ol style="list-style-type: decimal">
<li><p><em>Aandelenindex - Rentepercentage</em> - Er is een lineair verband te zien. Als het <code>Rentepercentage</code> omhoog gaat, gaat ook de <code>Aandelenindex</code> omhoog. Er is een positief verband. En een voldoend hoge R-kwadraat van 0,8757.</p></li>
<li><p><em>Aandelenindex - Werkloosheidspercentage</em> - Er is een lineair verband te zien. Als het <code>Werkloosheidspercentage</code> omhoog gaat, gaat de <code>Aandelenindex</code> omlaag. Er is een negatief verband. En een voldoend hoge R-kwadraat van 0,8507.</p></li>
</ol>
<p>Er wordt nu een meervoudig lineair model opgesteld met de formule</p>
<p><span class="math inline">\(Aandelenindex = \beta_0 + \beta_1 * Renteperc + \beta_2 * Werkloosheidsperc + \epsilon\)</span></p>
<p>Bij het dialoogscherm Regressie in Gegevensanalyse moet je er wel op letten dat je in het invoerbereik voor X beide onafhankelijke variabelen opneemt, zie figuur <a href="linregressie.html#fig:ecdata-regressie">6.16</a>.</p>
<div class="figure" style="text-align: center">
<span id="fig:ecdata-regressie"></span>
<img src="images/linregressie/ecdata-regressie.png" alt="Dialoogscherm regressie voor economiedata." width="70%"><p class="caption">
Figuur 6.16: Dialoogscherm regressie voor economiedata.
</p>
</div>
<p>Vervolgens wordt een regressie-analyse via Gegevensanalyse uitgevoerd.</p>
<div class="figure" style="text-align: center">
<span id="fig:ecdata-samenvatting"></span>
<img src="images/linregressie/ecdata-samenvatting.png" alt="Samenvatting regressie meervoudige lineaire regressie." width="70%"><p class="caption">
Figuur 6.17: Samenvatting regressie meervoudige lineaire regressie.
</p>
</div>
<p>Zowel de correlatiecoëfficient als R-kwadraat zijn in dit meervoudige model hoger dan voor de afzonderlijke relaties. Dicht bij 1, dus goed.</p>
<div class="figure" style="text-align: center">
<span id="fig:ecdata-coefficienten"></span>
<img src="images/linregressie/ecdata-coefficienten.png" alt="Coéfficiënten regressievergelijking." width="100%"><p class="caption">
Figuur 6.18: Coéfficiënten regressievergelijking.
</p>
</div>
<p>De regressievergelijking wordt <span class="math inline">\(Aandelenindex = 1798,40 + 345,54 * Rentepercentage - 250,15 * Werkloosheidspercentage + \epsilon\)</span></p>
<p>Alleen de p-waarde voor het Rentepercentage is flink beneden 0,05. Voor het snijpunt en werkloosheidspercentage is deze respectievelijk iets er boven en iets eronder. Het model kan dus waarschijnlijk nog wel verbeterd worden.</p>
<p>Het gemiddelde en de som van de residuen is nagenoeg nul, wat dus weer goed is. Voor de diagrammen van de residuen</p>
<div class="figure" style="text-align: center">
<span id="fig:ecdata-residu"></span>
<img src="images/linregressie/ecdata-residu1.png" alt="Diagrammen van de residuen." width="50%"><img src="images/linregressie/ecdata-residu2.png" alt="Diagrammen van de residuen." width="50%"><p class="caption">
Figuur 6.19: Diagrammen van de residuen.
</p>
</div>
<p>Bij beide diagrammen zijn de residuen willekeurig verdeeld en is er geen patroon waar te nemen.</p>
<p>Samenvattend is het meervoudige lineaire model een redelijk model. Onderzocht zou moeten worden of er nog verbetering vatbaar is. Zo ligt het voor de hand om hier een mogelijke interactie tussen de onafhankelijke variabelen in het model mee te nemen. Bij een model met twee onafhankelijke variabelen ziet het model er dan als volgt uit:</p>
<p><span class="math inline">\(y = \beta_0 + \beta_1 * x_1 + \beta_2 * x_2 + \beta_3 * x_1 * x_2 + \epsilon\)</span></p>
<p>Naast dat dit in Excel veel handwerk met zich meebrengt, is dit ook geen lineair model meer en valt een uitwerking hiervan buiten het bestek van dit boek.</p>
</div>
<div id="voorspellen" class="section level2" number="6.5">
<h2>
<span class="header-section-number">6.5</span> Voorspellen<a class="anchor" aria-label="anchor" href="#voorspellen"><i class="fas fa-link"></i></a>
</h2>
<p>Wanneer je eenmaal een betrouwbaar regressiemodel gemaakt hebt, dan kun je hiermee de waarde van de afhankelijke variabele schatten, door de waarden voor de onafhankelijke variabelen in de regressievergelijking in te vullen.</p>
<p>Hierbij is wel een kanttekening te maken. Modellen hebben echte beperkingen. Het lineaire regressiemodel is opgesteld voor een bepaald bereik van de onafhankelijke variabelen. Je weet niet hoe de gegevens zich buiten dat bereik gaan gedragen. Het toepassen van een model voor een schatting op waarden buiten het het bereik van de oorspronkelijke gegevens wordt <strong>extrapolatie</strong> genoemd. Over het algemeen is een lineair model slechts een benadering van de werkelijke relatie tussen twee variabelen. En als je dan gaat extrapoleren, dan maak je een onbetrouwbare gok dat deze relatie ook geldig is op plaatsen waar deze niet is geanalyseerd.</p>
<p>Ter toelichting een voorbeeld. De gevonden vergelijking bij de meervoudige lineaire regresie, zie <a href="linregressie.html#linreg-meervoudig">6.4</a>, luidt</p>
<p><span class="math inline">\(Aandelenindex = 1798,40 + 345,54 * Rentepercentage - 250,15 * Werkloosheidspercentage\)</span></p>
<p>Bij een werkloosheidspercentage van 6,0 en een negatieve rente (niet ondenkbaar) van -0,5 is de aandelenindex 125. En bij een negatieve rente van -1,0 zou de aandelenindex zelfs -48 zijn!! Dat kan natuurlijk niet.</p>
</div>
<div id="opg-linreg" class="section level2" number="6.6">
<h2>
<span class="header-section-number">6.6</span> Opgaven<a class="anchor" aria-label="anchor" href="#opg-linreg"><i class="fas fa-link"></i></a>
</h2>
<div class="sectionexercise">
<ol style="list-style-type: decimal">
<li><p>In <a href="linregressie.html#linreg-enkelvoudig">6.3</a> is een regressie-analyse besproken met de data in tabel <a href="linregressie.html#tab:sim1-data">6.1</a>. Voer deze analyse in Excel uit. Experimenteer met de uitvoeropties die Gegevensanalyse biedt. De dataset kun je ook downloaden als <a href="data/sim1.csv">sim1.csv</a>.</p></li>
<li><p>Voer in Excel de analyse uit het voorbeeld <a href="linregressie.html#sim2">6.3.4</a> uit. De dataset kun je ook downloaden als <a href="data/sim2.csv">sim2.csv</a>.</p></li>
<li><p>In het bestand <a href="data/salaris_data.csv">salaris_data.csv</a> is van 30 personen het salaris en het aantal jaren ervaring verzameld. Stel hiervoor een lineair regressiemodel op.</p></li>
<li>
<p>Een fabrikant van energierepen wil de dalende omzet van het topprodukt “GreenBull” weer een impuls geven. Om een plan hiervoor te ontwikkelen zijn via een steekproef in 34 winkels een aantal gegevens verzameld, welke te vinden zijn in het bestand <a href="data/energiereep.xlsx">energiereep.xlsx</a>. Stel hiervoor een meervoudig lineair regressiemodel op. De verzamelde gegevens zijn:</p>
<ul>
<li><code>winkelnr</code></li>
<li>
<code>omzet</code> - aantal verkochte repen per maand in de winkel</li>
<li>
<code>prijs</code> - verkoopprijs reep (centen)</li>
<li>
<code>promotiekosten</code> - maandelijkse kosten voor promotie van het produkt in de winkel (euros)</li>
</ul>
</li>
</ol>
</div>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="eda.html"><span class="header-section-number">5</span> Exploratieve Data Analyse (EDA)</a></div>
<div class="next"><a href="timeseries.html"><span class="header-section-number">7</span> Tijdreeksen</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#linregressie"><span class="header-section-number">6</span> Samenhang en lineaire regressie</a></li>
<li><a class="nav-link" href="#samenhang"><span class="header-section-number">6.1</span> Samenhang</a></li>
<li><a class="nav-link" href="#lineair-verband"><span class="header-section-number">6.2</span> Lineair verband</a></li>
<li>
<a class="nav-link" href="#linreg-enkelvoudig"><span class="header-section-number">6.3</span> Enkelvoudige lineaire regressie</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#methode---formules"><span class="header-section-number">6.3.1</span> Methode - Formules</a></li>
<li><a class="nav-link" href="#methode---spreidingsdiagram-met-trendlijn"><span class="header-section-number">6.3.2</span> Methode - Spreidingsdiagram met trendlijn</a></li>
<li><a class="nav-link" href="#methode---gegevensanalyse"><span class="header-section-number">6.3.3</span> Methode - Gegevensanalyse</a></li>
<li><a class="nav-link" href="#sim2"><span class="header-section-number">6.3.4</span> Voorbeeld Druk-Temperatuur</a></li>
</ul>
</li>
<li><a class="nav-link" href="#linreg-meervoudig"><span class="header-section-number">6.4</span> Meervoudige lineaire regressie</a></li>
<li><a class="nav-link" href="#voorspellen"><span class="header-section-number">6.5</span> Voorspellen</a></li>
<li><a class="nav-link" href="#opg-linreg"><span class="header-section-number">6.6</span> Opgaven</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Excel Data Analyse</strong>" was written by Ben Welman. It was last built on 29 april 2021.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
