<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Hoofdstuk 1 Importeren van data | Excel Data Analyse</title>
<meta name="author" content="Ben Welman">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.7.10/header-attrs.js"></script><script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.4/tabs.js"></script><script src="libs/bs3compat-0.2.4/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><meta name="description" content="Cursus data analyse met Excel">
<meta name="keywords" content="tutorial, cursus, studieboek, excel, data analyse, gegevensanalyse, statistiek, tijdreeksen, voorspellingen, prognoses, ETS">
<meta name="robots" content="index,follow">
<meta name="twitter:title" content="Cursus data analyse met Excel">
<meta name="twitter:description" content="Cursus data analyse met Excel">
<meta name="twitter:url" content="https://excelanalyse.netlify.app/">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@benwem">
<meta name="twitter:site" content="@benwem">
<meta property="og:title" content="Cursus data analyse met Excel">
<meta property="og:description" content="Cursus data analyse met Excel">
<meta property="og:url" content="https://excelanalyse.netlify.app/">
<meta property="og:type" content="book">
<meta property="og:locale" content="nl_NL">
<meta property="article:author" content="Ben Welman">
<script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet">
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script><script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script><script src="libs/viz-1.8.2/viz.js"></script><link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">
<script src="libs/grViz-binding-1.0.6.1/grViz.js"></script><script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-1284000-9', 'auto');
      ga('send', 'pageview');

    </script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS --><link rel="stylesheet" href="css/textbook.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Ga naar de hoofdinhoud</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Excel Data Analyse</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Toon inhoudsopgave</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Zoeken" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Inhoudsopgave</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welkom</a></li>
<li><a class="" href="voorwoord.html">Voorwoord</a></li>
<li><a class="active" href="importdata.html"><span class="header-section-number">1</span> Importeren van data</a></li>
<li><a class="" href="data.html"><span class="header-section-number">2</span> Data</a></li>
<li><a class="" href="beschrijvend.html"><span class="header-section-number">3</span> Beschrijvende statistiek</a></li>
<li><a class="" href="grafieken.html"><span class="header-section-number">4</span> Grafieken</a></li>
<li><a class="" href="eda.html"><span class="header-section-number">5</span> Exploratieve Data Analyse (EDA)</a></li>
<li><a class="" href="linregressie.html"><span class="header-section-number">6</span> Samenhang en lineaire regressie</a></li>
<li><a class="" href="timeseries.html"><span class="header-section-number">7</span> Tijdreeksen</a></li>
<li><a class="" href="prognoses.html"><span class="header-section-number">8</span> Prognoses</a></li>
<li><a class="" href="cases.html"><span class="header-section-number">9</span> Cases</a></li>
<li class="book-part">Bijlagen</li>
<li><a class="" href="app-toolpak.html"><span class="header-section-number">A</span> Addin Gegevensanalyse</a></li>
<li><a class="" href="app-query-options.html"><span class="header-section-number">B</span> Power Query opties</a></li>
<li><a class="" href="app-excel-trendlijnen.html"><span class="header-section-number">C</span> Excel Trendlijnen</a></li>
<li><a class="" href="app-voorspellingenblad.html"><span class="header-section-number">D</span> Voorspellingenblad</a></li>
<li><a class="" href="app-aselect.html"><span class="header-section-number">E</span> Aselecte getallen</a></li>
<li><a class="" href="referenties.html">Referenties</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="importdata" class="section level1" number="1">
<h1>
<span class="header-section-number">Hoofdstuk 1</span> Importeren van data<a class="anchor" aria-label="anchor" href="#importdata"><i class="fas fa-link"></i></a>
</h1>
<div class="chapterintro">
<p>Bij de analyse van data probeer je antwoorden te vinden op vragen door statistische methodes toe te passen op waarnemingen. Deze waarnemingen - verzameld uit rapportages, enquêtes en experimenten - vormen de ruggegraat van een statistisch onderzoek en worden <strong>data</strong> genoemd. In de praktijk komen veel gegevens uit externe bronnen: txt/csv, web, excel bestanden, databases, … Om deze gegevens in Excel te analyseren, moeten ze eerst geïmporteerd worden en soms worden getransformeerd en opgeschoond. Dat gebeurt met Power Query.</p>
</div>
<p>In Excel is Power Query beschikbaar onder de groep <em>Gegevens ophalen en transformeren</em> in het lint <em>Gegevens</em>. Hiermee kun je verbindingen maken met meerdere gegevensbronnen en daarna die gegevens structureren (bijvoorbeeld een kolom verwijderen, een gegevenstype wijzigen) of de gegevens omzetten (transformeren) naar wat anders. Uiteindelijk komen de gegevens dan in een Excel werkblad beschikbaar. Alle stappen die je met de Power Query Editor uitvoert worden in een script vastgelegd.</p>
<p>Deze aanbevolen werkwijze heeft de volgende voordelen:</p>
<ul>
<li>De oorspronkelijke gegevens blijven onveranderd.</li>
<li>Omdat de uitgevoerde acties in een script zijn vastgelegd heb je tevens een vorm van documentatie van wat je met de gegevens gedaan hebt.</li>
<li>In het script kun je eenvoudig een stap wijzigen, ongedaan maken of een nieuwe stap toevoegen.</li>
<li>Wanneer er wijzigingen of aanvullingen in de brondata komen hoef je de query alleen maar opnieuw uit te voeren waarna de gewijzigde gegevens in het werkblad verschijnen.</li>
</ul>
<div id="gegevens-ophalen-en-transformeren" class="section level2" number="1.1">
<h2>
<span class="header-section-number">1.1</span> Gegevens ophalen en transformeren<a class="anchor" aria-label="anchor" href="#gegevens-ophalen-en-transformeren"><i class="fas fa-link"></i></a>
</h2>
<p>Om Gegevens ophalen en transformeren in Excel te gebruiken, maak je eigenlijk een query in de werkmap. Met een query kun je een verbinding maken met een breed scala aan beschikbare gegevensbronnen, een voorbeeld van de gegevens bekijken en de gegevens transformeren.</p>
<p>De eerste stap is het maken van een verbinding met een gegevensbron. Wanneer de verbinding is gemaakt, krijg je een voorbeeld van de gegevens te zien. Daarna kun je stappen toevoegen om de gegevens te structureren en te transformeren. Hiervoor wordt een Query Editor gestart om een aantal instructies te maken die de acties uitvoeren. De laatste stap is het laden van de gegevens als een tabel in een werkblad.</p>
<div class="tip">
<ul>
<li>Je hebt ook de mogelijkheid om de gegevens te laden in het ingebouwde gegevensmodel.</li>
<li>Je kunt de query later ook wijzigen en/of de gegevens vernieuwen.</li>
</ul>
</div>
<p>Voor het maken van een query gebruik je de <em>tab Gegevens</em> in het lint, waarna je een van de mogelijke acties in de <em>Gegevens ophalen en transformeren</em> groep kiest.</p>
<div class="figure" style="text-align: center">
<span id="fig:ribbon-queries"></span>
<img src="images/importdata/ribbon_queries.png" alt="Lint gegevens." width="100%"><p class="caption">
Figuur 1.1: Lint gegevens.
</p>
</div>
<p>Er zijn knoppen voor het ophalen van gegevens uit tekst/csv, web en een Excel tabel/bereik. Deze gegevensbronnen en nog veel meer zijn beschikbaar via de knop <em>Gegevens ophalen</em>.</p>
<p>De groep <em>Query’s en verbindingen</em> heeft een knop voor het vernieuwen van query’s en een knop om bestaande query’s en verbindingen te bekijken en te beheren.</p>
</div>
<div id="importeren-van-een-tekstcsv-bestand" class="section level2" number="1.2">
<h2>
<span class="header-section-number">1.2</span> Importeren van een tekst/csv bestand<a class="anchor" aria-label="anchor" href="#importeren-van-een-tekstcsv-bestand"><i class="fas fa-link"></i></a>
</h2>
<p>Veel gegevens in externe bronnen zijn beschikbaar als tekst (bestandstype <code>.txt</code>) of via komma (of karakter) gescheiden waarden (bestandstype <code>.csv</code>).</p>
<ol style="list-style-type: decimal">
<li><p>Download eerst het hulpbestand <a href="data/SalesJan2009.csv">SalesJan2009.csv</a> en open daarna een nieuwe lege werkmap.</p></li>
<li><p>Kies <em>tab Gegevens &gt; Uit tekst/CSV (groep Gegevens ophalen en transformeren)</em>.</p></li>
<li><p>Blader naar het hulpbestand en klik <em>Importeren</em>.
Een voorbeeld van de gegevens wordt getoond.</p></li>
</ol>
<div class="figure" style="text-align: center">
<span id="fig:salesjan2009-preview"></span>
<img src="images/importdata/salesjan2009_preview.png" alt="Voorbeeld van SalesJan2009 gegevens." width="100%"><p class="caption">
Figuur 1.2: Voorbeeld van SalesJan2009 gegevens.
</p>
</div>
<ol start="4" style="list-style-type: decimal">
<li><p>Klik op <em>Gegevens transformeren</em>.
De Query Editor wordt gestart in een nieuw venster. Aan de rechterkant onder <em>Queryinstellingen</em> en onder <em>Toegepaste Stappen</em> zie je de stappen die reeds zijn toegepast.</p></li>
<li><p>Selecteer de kolommen <code>Account_Created</code>, <code>Last_Login</code>, <code>Latitude</code>, <code>Longitude</code>, door op de kolomkop te klikken met ingedrukte CTRL toets. Kies dan <em>Kolommen verwijderen (groep Kolommen beheren) &gt; Kolommen verwijderen</em>. De kolommen worden verwijderd en de stap is toegevoegd aan <em>Toegepaste Stappen</em>.</p></li>
</ol>
<div class="tip">
<p>Als alternatief kun je de rechtermuisknop gebruiken en dan de gewenste actie uit het snelmenu kiezen.</p>
</div>
<p>In elke kolomkop zit aan de linkerkant een knopje welke het toegepaste gegevenstype weergeeft. Wanneer je een kolom selecteert zie je het gegevenstype ook op het lint. En dit is tevens de plek waar je het gegevenstype kunt wijzigen.</p>
<div class="figure" style="text-align: left">
<span id="fig:datatype"></span>
<img src="images/importdata/ribbon_datatype_wholenumber.png" alt="Gegevenstype." width="40%"><p class="caption">
Figuur 1.3: Gegevenstype.
</p>
</div>
<p><code>Price</code> heeft gegevenstype <em>Geheel getal</em>, alle andere kolommen hebben gegevenstype <em>Tekst</em>.</p>
<ol start="6" style="list-style-type: decimal">
<li><p>Selecteer de eerste kolom <code>Transaction_date</code> en kies dan <em>Gegevenstype (groep Transformeren) &gt; Datum/Tijd</em>. Wanneer er een dialoogscherm komt met de vraag of de bestaande conversie vervangen moet worden, kies dan voor vervangen van de huidige conversie.
In kolom <code>Name</code> beginnen de meeste namen met een hoofdletter, maar niet allemaal.</p></li>
<li><p>Selecteer kolom <code>Name</code>, rechtermuisklik en kies <em>Transformeren &gt; Elk Woord Met Een Hoofdletter</em>.</p></li>
<li><p>Kies <em>Sluiten en laden(groep Sluiten) &gt; Sluiten en laden</em>.
De gegevens worden in een Excel tabel in een nieuw werkblad opgeslagen. Je kunt nu met de gegevens werken en de Excel map voor later gebruik opslaan.</p></li>
</ol>
<div class="tip">
<p>Het is altijd mogelijk om de query achteraf te wijzigen. Selecteer hiervoor een cel in de tabel en kies <em>tab Query &gt; Bewerken (groep Bewerken)</em>. De Query Editor wordt weer opgestart. Van hieruit kun je tevens de gegevens vernieuwen, alle stappen worden dan herhaald.</p>
</div>
</div>
<div id="importeren-van-een-webtabel" class="section level2" number="1.3">
<h2>
<span class="header-section-number">1.3</span> Importeren van een webtabel<a class="anchor" aria-label="anchor" href="#importeren-van-een-webtabel"><i class="fas fa-link"></i></a>
</h2>
<p>Webpagina’s hebben vaak tabellen. De Power Query in Excel kan deze tabellen herkennen en importeren. In deze taak ga je een aantal gegevens van de UEFA Europees voetbalkampioenschap importeren die in een wikipedia pagina beschikbaar zijn.</p>
<ol style="list-style-type: decimal">
<li><p>Open een nieuwe lege werkmap.</p></li>
<li><p>Kies <em>tab Gegevens &gt; Van het web (groep Gegevens ophalen en transformeren)</em>. Er wordt een dialoogvenster weergegeven waarin de URL van de webpagina moet worden ingevoerd.</p></li>
</ol>
<div class="figure" style="text-align: center">
<span id="fig:weburl-textbox"></span>
<img src="images/importdata/web_url_textbox.png" alt="Dialoogvenster voor invoer URL." width="70%"><p class="caption">
Figuur 1.4: Dialoogvenster voor invoer URL.
</p>
</div>
<ol start="3" style="list-style-type: decimal">
<li>Voer voor de URL in <code>http://en.wikipedia.org/wiki/UEFA_European_Championship</code> en klik <em>OK</em>.</li>
</ol>
<p>Er wordt een verbinding met de webpagina gemaakt.
Wanneer de verbinding gerealiseerd is wordt een <em>Navigator</em> venster getoond waarin een lijst met alle tabellen in de webpagina te zien is. Door op een tabel te klikken verschijnt aan de rechterkant van het venster een voorbeeld van de gegevens.</p>
<div class="figure" style="text-align: center">
<span id="fig:uefa-navigatorpane"></span>
<img src="images/importdata/uefa_navigatorpane.png" alt="Venster Navigator voor UEFA pagina op Wikipedia." width="70%"><p class="caption">
Figuur 1.5: Venster Navigator voor UEFA pagina op Wikipedia.
</p>
</div>
<ol start="4" style="list-style-type: decimal">
<li>Selecteer tabel <code>Results[edit]</code> en klik dan op de knop <em>Gegevens transformeren</em>.
De Query Editor wordt gestart in een nieuw venster. Aan de rechterkant onder <em>Queryinstellingen</em> en onder <em>Toegepaste Stappen</em> zie je de stappen die reeds zijn toegepast.</li>
</ol>
<p>Vervolgens kun je de gegevens naar behoefte structureren, wijzigen en opschonen. Achtereenvolgens ga je</p>
<ul>
<li>alle kolommen verwijderen behalve <code>Year</code> en <code>Final Winner</code>s.</li>
<li>het woord “Details” verwijderen in kolom <code>Year</code>.</li>
<li>alleen echte jaartallen in kolom <code>Year</code> overhouden.</li>
</ul>
<ol start="5" style="list-style-type: decimal">
<li><p>Selecteer de kolommen <code>Year</code> en <code>Final Winners</code> door op de kolomkoppen te klikken met ingedrukte CTRL toets. Kies dan <em>Kolommen verwijderen (groep Kolommen beheren) &gt; Andere kolommen verwijderen</em>.</p></li>
<li><p>Selecteer kolom <code>Year</code> en kies <em>Waarden vervangen (groep Transformeren)</em>. Het dialoogvenster <em>Waarden vervangen</em> wordt weergegeven.</p></li>
</ol>
<div class="figure" style="text-align: center">
<span id="fig:replace-values-dialogbox"></span>
<img src="images/importdata/replace_values_dialogbox.png" alt="Dialoogvenster Waarden vervangen." width="70%"><p class="caption">
Figuur 1.6: Dialoogvenster Waarden vervangen.
</p>
</div>
<ol start="7" style="list-style-type: decimal">
<li><p>Type <code>Details</code> in het tekstvak <em>Te zoeken waarde</em> en laat het tekstvak <em>Vervangen door</em> leeg en klik <em>OK</em>.</p></li>
<li><p>Selecteer kolom <code>Year</code> en klik op de filter keuzepijl in de kolomkop. Deselecteer <code>Year</code> en klik <em>OK</em>.</p></li>
<li><p>Kies <em>Sluiten en laden(groep Sluiten) &gt; Sluiten en laden</em>.
De gegevens worden in een Excel tabel in een nieuw werkblad opgeslagen. Je kunt nu met de gegevens werken en de Excel map voor later gebruik opslaan.</p></li>
</ol>
</div>
<div id="opg-importdata" class="section level2" number="1.4">
<h2>
<span class="header-section-number">1.4</span> Opgaven<a class="anchor" aria-label="anchor" href="#opg-importdata"><i class="fas fa-link"></i></a>
</h2>
<div class="sectionexercise">
<ol style="list-style-type: decimal">
<li>
<p><strong>Eenvoudig csv bestand importeren</strong></p>
<p>Download het hulpbestand <a href="data/verkopen.csv">verkopen.csv</a> en open het eerst met een kale tekstverwerker (Kladblok, Notepad) om te onderzoeken hoe het bestand er uit ziet. Het is belangrijk om te weten is of er veldnamen in staan en welk scheidingssymbool (komma, puntkomma, …) gebruikt is. Meestal herkent Excel dit zelf, maar het is toch wel nuttig om dit zelf eerst na te gaan.</p>
<p>Importeer de gegevens via <em>Gegevens ophalen en transformeren</em>. Gebruik hierbij ook de query editor om te controleren of de velden naar het juiste gegevenstype zijn omgezet. Zo niet, wijzig dan het gevenstype.</p>
</li>
</ol>
</div>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="voorwoord.html">Voorwoord</a></div>
<div class="next"><a href="data.html"><span class="header-section-number">2</span> Data</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>Op deze pagina</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#importdata"><span class="header-section-number">1</span> Importeren van data</a></li>
<li><a class="nav-link" href="#gegevens-ophalen-en-transformeren"><span class="header-section-number">1.1</span> Gegevens ophalen en transformeren</a></li>
<li><a class="nav-link" href="#importeren-van-een-tekstcsv-bestand"><span class="header-section-number">1.2</span> Importeren van een tekst/csv bestand</a></li>
<li><a class="nav-link" href="#importeren-van-een-webtabel"><span class="header-section-number">1.3</span> Importeren van een webtabel</a></li>
<li><a class="nav-link" href="#opg-importdata"><span class="header-section-number">1.4</span> Opgaven</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Excel Data Analyse</strong>" is geschreven door Ben Welman. Laatste productiedatum 14 april 2021.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>Dit boek is gemaakt met de <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
