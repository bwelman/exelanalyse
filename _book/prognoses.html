<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Hoofdstuk 8 Prognoses | Excel Data Analyse</title>
<meta name="author" content="Ben Welman">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.7.10/header-attrs.js"></script><script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.4/tabs.js"></script><script src="libs/bs3compat-0.2.4/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><meta name="description" content="Cursus data analyse met Excel">
<meta name="keywords" content="tutorial, cursus, studieboek, excel, data analyse, gegevensanalyse, statistiek, tijdreeksen, voorspellingen, prognoses, ETS">
<meta name="robots" content="index,follow">
<meta name="twitter:title" content="Cursus data analyse met Excel">
<meta name="twitter:description" content="Cursus data analyse met Excel">
<meta name="twitter:url" content="https://excelanalyse.netlify.app/">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@benwem">
<meta name="twitter:site" content="@benwem">
<meta property="og:title" content="Cursus data analyse met Excel">
<meta property="og:description" content="Cursus data analyse met Excel">
<meta property="og:url" content="https://excelanalyse.netlify.app/">
<meta property="og:type" content="book">
<meta property="og:locale" content="nl_NL">
<meta property="article:author" content="Ben Welman">
<script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet">
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script><script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script><script src="libs/viz-1.8.2/viz.js"></script><link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">
<script src="libs/grViz-binding-1.0.6.1/grViz.js"></script><script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-1284000-9', 'auto');
      ga('send', 'pageview');

    </script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS --><link rel="stylesheet" href="css/textbook.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Ga naar de hoofdinhoud</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Excel Data Analyse</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Toon inhoudsopgave</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Zoeken" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Inhoudsopgave</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welkom</a></li>
<li><a class="" href="voorwoord.html">Voorwoord</a></li>
<li><a class="" href="importdata.html"><span class="header-section-number">1</span> Importeren van data</a></li>
<li><a class="" href="data.html"><span class="header-section-number">2</span> Data</a></li>
<li><a class="" href="beschrijvend.html"><span class="header-section-number">3</span> Beschrijvende statistiek</a></li>
<li><a class="" href="grafieken.html"><span class="header-section-number">4</span> Grafieken</a></li>
<li><a class="" href="eda.html"><span class="header-section-number">5</span> Exploratieve Data Analyse (EDA)</a></li>
<li><a class="" href="linregressie.html"><span class="header-section-number">6</span> Samenhang en lineaire regressie</a></li>
<li><a class="" href="timeseries.html"><span class="header-section-number">7</span> Tijdreeksen</a></li>
<li><a class="active" href="prognoses.html"><span class="header-section-number">8</span> Prognoses</a></li>
<li><a class="" href="cases.html"><span class="header-section-number">9</span> Cases</a></li>
<li class="book-part">Bijlagen</li>
<li><a class="" href="app-toolpak.html"><span class="header-section-number">A</span> Addin Gegevensanalyse</a></li>
<li><a class="" href="app-query-options.html"><span class="header-section-number">B</span> Power Query opties</a></li>
<li><a class="" href="app-excel-trendlijnen.html"><span class="header-section-number">C</span> Excel Trendlijnen</a></li>
<li><a class="" href="app-voorspellingenblad.html"><span class="header-section-number">D</span> Voorspellingenblad</a></li>
<li><a class="" href="app-aselect.html"><span class="header-section-number">E</span> Aselecte getallen</a></li>
<li><a class="" href="referenties.html">Referenties</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="prognoses" class="section level1" number="8">
<h1>
<span class="header-section-number">Hoofdstuk 8</span> Prognoses<a class="anchor" aria-label="anchor" href="#prognoses"><i class="fas fa-link"></i></a>
</h1>
<div class="chapterintro">
<p>Voor het schatten van toekomstige waarden zijn verschillende (statistische) technieken beschikbaar. Naast de zeer eenvoudige naïeve prognose komt de meer geavanceerdere exponentïele vereffening (smoothing) aan bod. Ook wordt gekeken naar maatstaven om de nauwkeurigheid van de voorspelde waarden te beoordelen.</p>
</div>
<div id="prognoses-nauwkeurigheid" class="section level2" number="8.1">
<h2>
<span class="header-section-number">8.1</span> Nauwkeurigheid prognoses<a class="anchor" aria-label="anchor" href="#prognoses-nauwkeurigheid"><i class="fas fa-link"></i></a>
</h2>
<p>Hoe nauwkeurig zijn de voorspellingen die zijn verkregen met een bepaalde prognosetechniek? Om deze vraag te beantwoorden worden een aantal verschillende kentallen voor de voorspelling van de nauwkeurigheid geïntroduceerd.</p>
<p>Alles begint bij het bepalen van de <em>prognosefout</em>.</p>
<p><span class="math display">\[\text{(prognose)fout} = \text{werkelijke waarde} - \text{voorspelde waarde}\]</span></p>
<p>Je wilt uiteraard dat de prognosefouten zo klein mogelijk zijn. Omdat de fouten zowel positief als negatief kunnen zijn, heb je niet veel aan het gemiddelde van deze fouten. Vandaar dat altijd de absolute waarde van de fouten genomen wordt.</p>
<p>Er zijn verschillende kentallen ontwikkeld om de nauwkeurigheid te beoordelen. Deze worden meestal met hun Engelstalige afkorting gebruikt. Een paar veel voorkomende kentallen staan in tabel <a href="prognoses.html#tab:kentallen">8.1</a> genoemd.</p>
<div class="inline-table"><table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:kentallen">Tabel 8.1: </span>Enkele maatstaven voor de naukeurigheis van prognoses.
</caption>
<thead><tr>
<th style="text-align:left;">
Kental
</th>
<th style="text-align:left;">
Engelstalig
</th>
<th style="text-align:left;">
Nederlandstalig
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
MAE
</td>
<td style="text-align:left;">
Mean Absolute Error
</td>
<td style="text-align:left;">
Gemiddelde absolute fout
</td>
</tr>
<tr>
<td style="text-align:left;">
MAPE
</td>
<td style="text-align:left;">
Mean Absolute Percentage Error
</td>
<td style="text-align:left;">
Gemiddelde absolute procentuele fout
</td>
</tr>
<tr>
<td style="text-align:left;">
MSE
</td>
<td style="text-align:left;">
Mean Squared Error
</td>
<td style="text-align:left;">
Gemiddelde kwadratische afwijking
</td>
</tr>
<tr>
<td style="text-align:left;">
RMSE
</td>
<td style="text-align:left;">
Root Mean Squared Error
</td>
<td style="text-align:left;">
Wortel kwadratische afwijking
</td>
</tr>
</tbody>
</table></div>
<p>Je kunt niet zomaar een van deze kentallen als het beste kental beschouwen. In het algemeen geldt voor elk kental: hoe kleiner de waarde, des te beter.</p>
</div>
<div id="prognoses-naief" class="section level2" number="8.2">
<h2>
<span class="header-section-number">8.2</span> Naïeve prognose<a class="anchor" aria-label="anchor" href="#prognoses-naief"><i class="fas fa-link"></i></a>
</h2>
<p>Een van de meest eenvoudige prognosemethodes is de <em>naïeve prognose</em>. Hierbij is de prognose op een bepaald tijdstip gelijk aan de waarde op het voorgaande tijdstip. Voor het bepalen hiervan heb je geen ingewikkelde formules nodig. Ondanks dat deze methode erg simpel is, zijn de resultaten vaak verrassend goed. Het is aan te raden om altijd hiermee te starten en daarna andere methodes hiermee te vergelijken.</p>
<p>In tabel <a href="prognoses.html#tab:benzineverkoop-data">8.2</a> zie je de wekelijkse verkoop van liters (x 1000) benzine van een brandstofhandelaar.</p>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:benzineverkoop-data">Tabel 8.2: </span>Wekelijkse verkoop van benzine in duizend liters.
</caption>
<tbody>
<tr>
<td style="text-align:left;">
week
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
12
</td>
</tr>
<tr>
<td style="text-align:left;">
liters
</td>
<td style="text-align:right;">
69
</td>
<td style="text-align:right;">
79
</td>
<td style="text-align:right;">
74
</td>
<td style="text-align:right;">
64
</td>
<td style="text-align:right;">
57
</td>
<td style="text-align:right;">
76
</td>
<td style="text-align:right;">
83
</td>
<td style="text-align:right;">
66
</td>
<td style="text-align:right;">
84
</td>
<td style="text-align:right;">
63
</td>
<td style="text-align:right;">
66
</td>
<td style="text-align:right;">
74
</td>
</tr>
</tbody>
</table></div>
<p>In de lijngrafiek in figuur <a href="prognoses.html#fig:benzineverkoop-grafiek">8.1</a> zie je dat dit een horizontaal patroon met willekeurige fluctuaties rond het gemiddelde van <span class="math inline">\(71,25\)</span> is.</p>
<div class="figure" style="text-align: center">
<span id="fig:benzineverkoop-grafiek"></span>
<img src="images/prognoses/benzinegrafiek.png" alt="Aantal verkochte liters benzine (x 1000) per week." width="50%"><p class="caption">
Figuur 8.1: Aantal verkochte liters benzine (x 1000) per week.
</p>
</div>
<p>Voor deze gegevens wordt een naïeve prognose van de wekelijkse verkoop gemaakt, zie kolom 3 in figuur <a href="prognoses.html#fig:benzineverkoop-naief">8.2</a>.</p>
<div class="figure" style="text-align: center">
<span id="fig:benzineverkoop-naief"></span>
<img src="images/prognoses/benzinetabel-naief.png" alt="Naïeve prognose van de wekelijkse verkopen en berekening van een aantal kenmerken voor de nauwkeurigheid." width="50%"><p class="caption">
Figuur 8.2: Naïeve prognose van de wekelijkse verkopen en berekening van een aantal kenmerken voor de nauwkeurigheid.
</p>
</div>
<p>In de kolommen 4 t/m 6 zijn berekeningen voor de nauwkeurigheid uitgevoerd.</p>
<ul>
<li>
<em>abs. fout</em>: <code>=ABS(werkelijke waarde - prognosewaarde)</code>
</li>
<li>
<em>abs. proc. fout</em>: <code>=ABS(fout) / werkelijke waarde</code>
</li>
<li>
<em>kwadr. fout</em> <code>= fout^2</code>
</li>
<li>
<em>MAE</em>, <em>MAPE</em> en <em>MSE</em> zijn berekend met de formule <code>=GEMIDDELDE(...)</code>
</li>
<li>
<em>RMSE</em>: <code>=WORTEL(MSE)</code>
</li>
</ul>
<div class="guidedpractice">
<p>Wat is de verkoopprognose voor de weken 13 t/m 14?<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Voor de weken 13 t/m 15 is de prognose 74, de waarde van week 12. Wanneer de werkelijke verkoop voor week 13/14 beschikbaar is kan een nieuwe prognose voor week 14/15 gemaakt worden.&lt;/p&gt;"><sup>6</sup></a></p>
</div>
</div>
<div id="prognoses-naiefseizoen" class="section level2" number="8.3">
<h2>
<span class="header-section-number">8.3</span> Naïeve Seizoen prognose<a class="anchor" aria-label="anchor" href="#prognoses-naiefseizoen"><i class="fas fa-link"></i></a>
</h2>
<p>Voor een tijdreeks met een seizoenscomponent verloopt de naïeve prognose iets anders. In dat geval is de prognose op een bepaald tijdstip gelijk aan de waarde in hetzelfde seizoen in de voorgaande periode.</p>
<p>Als voorbeeld de kwartaalverkoop van paraplu’s over een periode van vijf jaar, zie de lijngrafiek figuur <a href="prognoses.html#fig:parapluverkoop-grafiek">8.3</a>.</p>
<div class="figure" style="text-align: center">
<span id="fig:parapluverkoop-grafiek"></span>
<img src="images/prognoses/paraplugrafiek.png" alt="Kwartaalverkoop paraplu's gedurende vijf jaar." width="70%"><p class="caption">
Figuur 8.3: Kwartaalverkoop paraplu’s gedurende vijf jaar.
</p>
</div>
<p>Deze grafiek lijkt op het eerste gezicht ook op een horizontaal patroon met willekeurige fluctuaties. Maar wanneer je goed kijkt zie je toch een systematisch patroon binnen elk jaar. Steeds is binnen elk jaar de verkoop in het tweede kwartaal het hoogst en in het vierde kwartaal het laagst. En de kwartalen 1 en 3 scoren redelijk gemiddeld.</p>
<p>Om te laten zien dat een naïeve seizoenprognose in een dergelijke tijdreeks beter is dan een gewone naïeve prognose worden beide prognoses bepaald. De resultaten, alsmede de kentallen voor de nauwkeurigheid zijn te zien in figuur <a href="prognoses.html#fig:parapluverkoop-prognose">8.4</a>. Voor de eerste vier kwartalen kunnen de naïeve seizoenprognoses niet bepaald worden, omdat er geen waarde in de voorgaande periode beschikbaar is.</p>
<div class="figure" style="text-align: center">
<span id="fig:parapluverkoop-prognose"></span>
<img src="images/prognoses/paraplutabel.png" alt="Naïeve en naïeve seizoenprognoses voor de Kwartaalverkoop van paraplu's." width="70%"><p class="caption">
Figuur 8.4: Naïeve en naïeve seizoenprognoses voor de Kwartaalverkoop van paraplu’s.
</p>
</div>
<p>De naïeve seizoensprognose toont voor alle kentallen de beste waarde.</p>
<div class="guidedpractice">
<p>Wat is de verkoopprognose voor de vier kwartalen van jaar 6?<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Voor jaar 6 is de naïef-seizoenprognose voor de kwartalen 1 t/m achtereenvolgens 65, 83, 64 en 48&lt;/p&gt;"><sup>7</sup></a></p>
</div>
</div>
<div id="prognoses-ma" class="section level2" number="8.4">
<h2>
<span class="header-section-number">8.4</span> Voortschrijdend gemiddelde<a class="anchor" aria-label="anchor" href="#prognoses-ma"><i class="fas fa-link"></i></a>
</h2>
<p>Via de methode van het voortschrijdend gemiddelde kun je ook prognoses maken. Als voorbeeld wordt de wekelijkse benzineverkoop genomen waarvoor eerder (figuur <a href="prognoses.html#fig:benzineverkoop-naief">8.2</a>) een naïeve prognose gemaakt is. Er wordt een 3-weeks voortschrijdend gemiddelde gekozen. De resultaten zijn te zien in figuur <a href="prognoses.html#fig:benzineverkoop-ma">8.5</a></p>
<div class="figure" style="text-align: center">
<span id="fig:benzineverkoop-ma"></span>
<img src="images/prognoses/benzinetabel-ma.png" alt="Voortschrijdend 3-weeks gemiddelde van de wekelijkse benzineverkopen." width="50%"><p class="caption">
Figuur 8.5: Voortschrijdend 3-weeks gemiddelde van de wekelijkse benzineverkopen.
</p>
</div>
<p>Bij een 3-weeks voortschrijdend gemiddelde kun je de eerste waarde pas berekenen voor week 4. En deze waarde is bepaald met de formule <code>=GEMIDDELDE(...)</code> met als argument de werkelijke waarden voor de 3 weken daarvoor.</p>
<p>Gelet op de kentallen voor de nauwkeurigheid zie je dat het voortschrijdend gemiddelde iets beter presteert dan de naïeve prognose, maar ook niet echt heel veel beter. En de prognose voor week 13 wordt <span class="math inline">\(67,67\)</span>.</p>
</div>
<div id="prognoses-expsmooth" class="section level2" number="8.5">
<h2>
<span class="header-section-number">8.5</span> Exponentiële demping<a class="anchor" aria-label="anchor" href="#prognoses-expsmooth"><i class="fas fa-link"></i></a>
</h2>
<p>Exponentiële demping (effening, smoothing) is een analysemethode voor tijdreeksen waarbij gewichten aan de waarnemingen worden toegekend. Het exponentiële smoothing model heeft de volgende vorm</p>
<p><span class="math inline">\(F_{t+1} = \alpha Y_t + (1-\alpha)F_t\)</span> , met</p>
<ul>
<li>
<span class="math inline">\(F_{t+1}\)</span>: de prognose (Engels: Forecast) op tijdstip <span class="math inline">\(t+1\)</span>
</li>
<li>
<span class="math inline">\(Y_t\)</span>: de werkelijke waarde op tijdstip <span class="math inline">\(t\)</span>
</li>
<li>
<span class="math inline">\(F_t\)</span>: de prognose op tijdstip <span class="math inline">\(t\)</span>
</li>
<li>
<span class="math inline">\(\alpha\)</span>: dempingscoëfficient (dempingsconstante) met <span class="math inline">\(0 \le \alpha \le 1\)</span>
</li>
</ul>
<p>De prognose op tijdstip <span class="math inline">\(t+1\)</span> is dus een gewogen gemiddelde van de werkelijke waarde op tijdstip <span class="math inline">\(t\)</span> en de prognose voor tijdstip <span class="math inline">\(t\)</span>, met als wegingsfactoren respectievelijk <span class="math inline">\(\alpha\)</span> en <span class="math inline">\(1 - \alpha\)</span>. Bij een grote waarde van <span class="math inline">\(\alpha\)</span> tellen de meest recente waarnemingen zwaarder mee dan de oudere waarnemingen. De prognoses kunnen daardoor sneller reageren op veranderende omstandigheden.</p>
<p>Voor het tijdstip <span class="math inline">\(t = 1\)</span> (het eerste tijdstip) kun je geen prognose berekenen. Voor tijdstip <span class="math inline">\(t = 2\)</span> (het tweede tijdstip) wordt de prognose gelijk aan de werkelijke waarde op tijdstip <span class="math inline">\(t = 1\)</span>. Voor alle volgende tijdstippen wordt de prognose berekend met de formule.</p>
<p>Als voorbeeld weer de wekelijkse benzineverkoop zodat de prognoses via exponentiële demping vergeleken kunnen worden met de naïeve prognose en die via het voortschrijdend gemiddelde.</p>
<div class="figure" style="text-align: center">
<span id="fig:benzineverkoop-ets"></span>
<img src="images/prognoses/benzinetabel-ets.png" alt="Prognose van de wekelijkse benzineverkopen via exponentiële demping met a=0,2." width="50%"><p class="caption">
Figuur 8.6: Prognose van de wekelijkse benzineverkopen via exponentiële demping met a=0,2.
</p>
</div>
<p>Gelet op de nauwkeurigheidswaarden zijn dit tot nu toe de beste voorspellingen. de prognose voor week 13 wordt <span class="math inline">\(71,0\)</span>.</p>
<div class="tip">
<p><strong>Keuze <span class="math inline">\(\alpha\)</span></strong></p>
<p>Als de tijdreeks een substantiële willekeurige variabiliteit heeft kun je het beste een kleine waarde voor <span class="math inline">\(\alpha\)</span> nemen. En bij een tijdreeks met weinig variabiliteit heeft een grotere waarde de voorkeur. De meest wenselijke waarde voor <span class="math inline">\(\alpha\)</span> is die waarde die de minste fouten oplevert, dus die zorgt voor de laagste gemiddelde kwardratische fout (MSE). In de praktijk ga je meestal proberen of een andere waarde voor <span class="math inline">\(\alpha\)</span> een nauwkeuriger voorspelling oplevert.</p>
</div>
<p><strong>Via gegevensanalyse</strong></p>
<p>In plaats van zelf de formules te bedenken en in te voeren kun je ook gebruik maken van <em>Gegevens &gt; Gegevensanalyse &gt; Exponentiële demping</em>. In het dialoogscherm (zie figuur <a href="prognoses.html#fig:dialoog-exp-demping">8.7</a>) vul je voor het invoerbereik het gebied met de werkelijke waarden in.</p>
<div class="important">
<p><strong>Dempingsfactor</strong></p>
<p>Voor de dempingsfactor moet je de waarde voor <span class="math inline">\(1 - \alpha\)</span> invullen. Om dezelfde resultaten te krijgen dus 0,8.</p>
</div>
<div class="figure" style="text-align: center">
<span id="fig:dialoog-exp-demping"></span>
<img src="images/prognoses/dialoog-exp-demping.png" alt="Dialoogscherm voor exponentiële demping" width="50%"><p class="caption">
Figuur 8.7: Dialoogscherm voor exponentiële demping
</p>
</div>
<p>Je krijgt dan dezelfde resultaten. Desgewenst kun je ook een grafiek produceren.</p>
<div class="figure" style="text-align: center">
<span id="fig:enzinegrafiek-ets"></span>
<img src="images/prognoses/benzinegrafiek-ets.png" alt="Lijndiagram van de benzineverkoop en de voorspelling via exponentiële demping met a=0,2." width="50%"><p class="caption">
Figuur 8.8: Lijndiagram van de benzineverkoop en de voorspelling via exponentiële demping met a=0,2.
</p>
</div>
<p>De eenvoud van deze methode heeft ook wel zijn prijs. Wil je experimenteren met een andere waarde voor <span class="math inline">\(\alpha\)</span> dan moet je de procedure weer opnieuw uitvoeren.</p>
</div>
<div id="prognoses-voorspellingenblad" class="section level2" number="8.6">
<h2>
<span class="header-section-number">8.6</span> Voorspellingenblad<a class="anchor" aria-label="anchor" href="#prognoses-voorspellingenblad"><i class="fas fa-link"></i></a>
</h2>
<p>De exponentiële effenings methoden zijn op dit moment de beste en meest gebruikte methodes. Het grootste voordeel van de ETS (Exponential Tripple Smoothing) methode is dat deze de mogelijkheid heeft om automatisch seizoenpatronen te ontdekken in de gegevensreeks en daarnaast ook nog een betrouwbaarheidsinterval voor de voorspellingen kan leveren.</p>
<div class="tip">
<p>Je kunt het beste deze methode gebruiken wanneer de tijdreeks zowel een trend als een seizoenspatroon laat zien.</p>
</div>
<p>In de nieuwere versies van Excel ( Excel 365, Excel 2016, Excel 2019, …) zijn de volgende werkbladfuncties voor het uitvoeren van de ETS methode beschikbaar:</p>
<ul>
<li><code>VOORSPELLEN.ETS</code></li>
<li><code>VOORSPELLEN.ETS.SEASONALITY</code></li>
<li><code>VOORSPELLEN.ETS.CONFINT</code></li>
<li><code>VOORSPELLEN.ETS.STAT</code></li>
</ul>
<p>Eenvoudiger is het gebruik van het <em>Voorspellingblad</em> of <em>prognosewerkblad</em> dat in die nieuwere Excel versies aanwezig is. Onder de motorkop worden de <code>VOORSPELLEN.ETS</code> functies gebruikt.</p>
<p>Via het Voorspellingenblad wordt een nieuw werkblad gemaakt met daarin een tabel met de oorspronkelijke gegevens en de voorspelde waarden. Deze toekomstige waarden worden berekend op basis van het Holt-Winters ETS algoritme. Ook wordt een grafiek gemaakt met de oorspronkelijke en voorspelde waarden en een aantal schattingen van meetwaarden voor de nauwkeurigheid. Hiermee wordt het maken van geavanceerde prognoses een stuk eenvoudiger.</p>
<div class="workedexample">
<ol style="list-style-type: decimal">
<li><p>Importeer het hulpbestand <a href="data//verkopen.csv">verkopen.csv</a> via <em>Gegevens ophalen en transformeren</em>. Voor hulp hierbij zie hoofdstuk Importeren gegevens.</p></li>
<li><p>Selecteer een willekeurige cel in het gegevensgebied.</p></li>
<li><p>Kies <em>tab Gegevens &gt; Voorspellingblad (groep Voorspelling)</em>. Het dialoogvenster Prognosewerkblad maken verschijnt.</p></li>
</ol>
<div class="figure" style="text-align: center">
<span id="fig:prognosewerkblad"></span>
<img src="images/prognoses/sales_fcast_sheet.png" alt="Prognosewerkblad maken" width="100%"><p class="caption">
Figuur 8.9: Prognosewerkblad maken
</p>
</div>
<p>In dit venster kun je een aantal keuzes maken. Zie bijlage <a href="app-voorspellingenblad.html#app-voorspellingenblad">D</a> voor een toelichting.</p>
<ol start="4" style="list-style-type: decimal">
<li>Stel <code>Einde van prognose</code> in op 1 december 2013.</li>
<li>Klik op <em>Opties</em>.</li>
</ol>
<div class="figure" style="text-align: center">
<span id="fig:sales-fcast-options"></span>
<img src="images/prognoses/sales_fcast_options.png" alt="Opties prognosewerkblad." width="100%"><p class="caption">
Figuur 8.10: Opties prognosewerkblad.
</p>
</div>
<ol start="6" style="list-style-type: decimal">
<li>Klik op <em>Maken</em>. Er wordt een nieuw werkblad gemaakt met daarin de historische gegevens, de voorspelde waarden, betrouwbaarheidsgrenzen (standaard 95%) en een grafiek.</li>
</ol>
<p>De resultaten van de voorspellingen staan in tabel <a href="prognoses.html#tab:voorspelling">8.3</a> weergegeven</p>
<div class="inline-table"><table class=" lightable-paper" style='font-size: 14px; font-family: "Arial Narrow", arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;'>
<caption style="font-size: initial !important;">
<span id="tab:voorspelling">Tabel 8.3: </span>Voorspelde waarden en betrouwbaarheidsgrenzen
</caption>
<thead><tr>
<th style="text-align:left;">
Datum
</th>
<th style="text-align:right;">
Voorspellen
</th>
<th style="text-align:right;">
Laagste betrouwbaarheidsgrens
</th>
<th style="text-align:right;">
Hoogste betrouwbaarheidsgrens
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
01-10-2013
</td>
<td style="text-align:right;">
4264177
</td>
<td style="text-align:right;">
3869915
</td>
<td style="text-align:right;">
4658439
</td>
</tr>
<tr>
<td style="text-align:left;">
01-11-2013
</td>
<td style="text-align:right;">
4033806
</td>
<td style="text-align:right;">
3639542
</td>
<td style="text-align:right;">
4428070
</td>
</tr>
<tr>
<td style="text-align:left;">
01-12-2013
</td>
<td style="text-align:right;">
4033625
</td>
<td style="text-align:right;">
3639358
</td>
<td style="text-align:right;">
4427892
</td>
</tr>
</tbody>
</table></div>
</div>
</div>
<div id="opg-prognoses" class="section level2" number="8.7">
<h2>
<span class="header-section-number">8.7</span> Opgaven<a class="anchor" aria-label="anchor" href="#opg-prognoses"><i class="fas fa-link"></i></a>
</h2>
<div class="sectionexercise">
<ol style="list-style-type: decimal">
<li>
<p><strong>Autoverkopen</strong></p>
<p>In het bestand <a href="data/autoverkoop.xlsx">autoverkoop.xlsx</a> staan de de autoverkopen per kwartaal van 4 jaren, zie ook <a href="timeseries.html#ts-ma-calc">7.3.1</a>. Maak met behulp van het Voorspellingenblad een prognose van de verkopen voor de vier kwartalen van jaar 5.</p>
</li>
<li>
<p><strong>Omzetvoorspelling</strong></p>
<p>In het bestand <a href="data/bedrijfsomzet.xlsx">bedrijfsomzet.xlsx</a> staan de omzetten van een bedrijf over de jaren 2007-2015.</p>
<ol style="list-style-type: lower-alpha">
<li>Maak een grafiek van de omzet tegen het jaar.</li>
<li>Voeg achtereenvolgens de volgende trendlijnen toe; lineair, logaritmisch en exponentieel.Verzamel voor elk van deze trendlijnen de waarde van R-kwadraat. Maak op basis hiervan een keuze voor het meest geschikte model.</li>
<li>Maak via de opties voor de trendlijn een voorspelling van de omzet voor 2016 en lees de waarde in de grafiek af.</li>
<li>Experimenteer met de opties voor de trendlijn om uit te zoeken wanneer een omzet van €25.000.000 te verwachten is.</li>
<li>Bereken een voorspelling van de omzet voor 2016 met een werkbladformule. Welke formule je hiervoor kunt gebruiken hangt af van het gekozen model. Zie hiervoor onderdeel.</li>
<li>Maak m.b.v. het Voorspellingenblad een prognose voor de omzet van 2016, alsmede een 95% betrouwbaarheidsinterval hiervoor.</li>
<li>Vergelijk de drie voorspelde waarden met elkaar.</li>
</ol>
</li>
<li>
<p><strong>Televisieverkoop</strong></p>
<p>In het bestand <a href="data/televisies.xlsx">televisies.xlsx</a> staan de verkochte aantallen televisies per kwartaal gedurende vier jaar.</p>
<ol style="list-style-type: lower-alpha">
<li>Maak een grafiek van de tijdreeks.</li>
<li>Is er een trend of een seizoenspatroon in de tijdreeks te ontdekken.</li>
<li>Maak een voorspelling van de verkoop voor de kwartalen van het volgende daar. Denk eerst na over welke prognosemethode je wilt gebruiken.</li>
</ol>
</li>
</ol>
</div>

</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="timeseries.html"><span class="header-section-number">7</span> Tijdreeksen</a></div>
<div class="next"><a href="cases.html"><span class="header-section-number">9</span> Cases</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>Op deze pagina</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#prognoses"><span class="header-section-number">8</span> Prognoses</a></li>
<li><a class="nav-link" href="#prognoses-nauwkeurigheid"><span class="header-section-number">8.1</span> Nauwkeurigheid prognoses</a></li>
<li><a class="nav-link" href="#prognoses-naief"><span class="header-section-number">8.2</span> Naïeve prognose</a></li>
<li><a class="nav-link" href="#prognoses-naiefseizoen"><span class="header-section-number">8.3</span> Naïeve Seizoen prognose</a></li>
<li><a class="nav-link" href="#prognoses-ma"><span class="header-section-number">8.4</span> Voortschrijdend gemiddelde</a></li>
<li><a class="nav-link" href="#prognoses-expsmooth"><span class="header-section-number">8.5</span> Exponentiële demping</a></li>
<li><a class="nav-link" href="#prognoses-voorspellingenblad"><span class="header-section-number">8.6</span> Voorspellingenblad</a></li>
<li><a class="nav-link" href="#opg-prognoses"><span class="header-section-number">8.7</span> Opgaven</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Excel Data Analyse</strong>" is geschreven door Ben Welman. Laatste productiedatum 14 april 2021.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>Dit boek is gemaakt met de <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
