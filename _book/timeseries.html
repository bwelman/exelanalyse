<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Hoofdstuk 7 Tijdreeksen | Excel Data Analyse</title>
<meta name="author" content="Ben Welman">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.7/header-attrs.js"></script><script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.4/tabs.js"></script><script src="libs/bs3compat-0.2.4/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><meta name="description" content="Cursus data analyse met Excel">
<meta name="keywords" content="tutorial, cursus, studieboek, excel, data analyse, gegevensanalyse, statistiek, tijdreeksen, voorspellingen, prognoses, ETS">
<meta name="robots" content="index,follow">
<meta name="twitter:title" content="Cursus data analyse met Excel">
<meta name="twitter:description" content="Cursus data analyse met Excel">
<meta name="twitter:url" content="https://excelanalyse.netlify.app/">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@benwem">
<meta name="twitter:site" content="@benwem">
<meta property="og:title" content="Cursus data analyse met Excel">
<meta property="og:description" content="Cursus data analyse met Excel">
<meta property="og:url" content="https://excelanalyse.netlify.app/">
<meta property="og:type" content="book">
<meta property="og:locale" content="nl_NL">
<meta property="article:author" content="Ben Welman">
<script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet">
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script><script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script><script src="libs/viz-1.8.2/viz.js"></script><link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">
<script src="libs/grViz-binding-1.0.6.1/grViz.js"></script><script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-1284000-9', 'auto');
      ga('send', 'pageview');

    </script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS --><link rel="stylesheet" href="css/textbook.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Excel Data Analyse</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Toon inhoudsopgave </span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Zoek" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Inhoud</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welkom</a></li>
<li><a class="" href="voorwoord.html">Voorwoord</a></li>
<li><a class="" href="importdata.html"><span class="header-section-number">1</span> Importeren van data</a></li>
<li><a class="" href="data.html"><span class="header-section-number">2</span> Data</a></li>
<li><a class="" href="beschrijvend.html"><span class="header-section-number">3</span> Beschrijvende statistiek</a></li>
<li><a class="" href="grafieken.html"><span class="header-section-number">4</span> Grafieken</a></li>
<li><a class="" href="eda.html"><span class="header-section-number">5</span> Exploratieve Data Analyse (EDA)</a></li>
<li><a class="" href="linregressie.html"><span class="header-section-number">6</span> Samenhang en lineaire regressie</a></li>
<li><a class="active" href="timeseries.html"><span class="header-section-number">7</span> Tijdreeksen</a></li>
<li><a class="" href="prognoses.html"><span class="header-section-number">8</span> Prognoses</a></li>
<li><a class="" href="cases.html"><span class="header-section-number">9</span> Cases</a></li>
<li class="book-part">Bijlagen</li>
<li><a class="" href="app-toolpak.html"><span class="header-section-number">A</span> Addin Gegevensanalyse</a></li>
<li><a class="" href="app-query-options.html"><span class="header-section-number">B</span> Power Query opties</a></li>
<li><a class="" href="app-excel-trendlijnen.html"><span class="header-section-number">C</span> Excel Trendlijnen</a></li>
<li><a class="" href="app-voorspellingenblad.html"><span class="header-section-number">D</span> Voorspellingenblad</a></li>
<li><a class="" href="app-aselect.html"><span class="header-section-number">E</span> Aselecte getallen</a></li>
<li><a class="" href="referenties.html">Referenties</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="timeseries" class="section level1" number="7">
<h1>
<span class="header-section-number">Hoofdstuk 7</span> Tijdreeksen<a class="anchor" aria-label="anchor" href="#timeseries"><i class="fas fa-link"></i></a>
</h1>
<div class="chapterintro">
<p>Veel bedrijfskritische beslissingen zijn afhankelijk van goede prognoses voor de toekomst. Het maken van een prognose is gebaseerd op historische gegevens en dat zijn meestal <em>tijdreeksen</em>, een reeks waarnemingen van een variabele gemeten op opeenvolgende tijdstippen of over opeenvolgende periodes.</p>
</div>
<div id="ts-intro" class="section level2" number="7.1">
<h2>
<span class="header-section-number">7.1</span> Introductie<a class="anchor" aria-label="anchor" href="#ts-intro"><i class="fas fa-link"></i></a>
</h2>
<p>De historische gegevens omvatten vaak trends, seizoenpatronen en externe factoren. Een tweetal veel voorkomende scenario’s zijn:</p>
<ul>
<li>Financiële prognoses voor het voorspellen van omzet, kosten en winst alsmede van indicatoren hiervoor zoals aantal nieuwe klanten of verkoopprijs.</li>
<li>Vraagvoorspellingen voor producten vormen een kritische stap in de supply-chain management van een organisatie. Hierop is de inkoop van grondstoffen en inzetten van mensen en machines weer gebaseerd. Vraagvoorspelling is vaak uniek voor een bedrijfstak. Zo zal een electriciteitsbedrijf een schatting willen maken van de te leveren energie in de toekomst. En een ziekenhuis zal het aantal benodigde bedden willen plannen.</li>
</ul>
<p>Voor een gedegen begrip van tijdreeksen en de verschillende prognosetechnieken is behoorlijke statistische kennis vereist. In dit studieboek worden de statistische achtergronden niet behandeld. Ook de hoeveelheid formules wordt zoveel mogelijk beperkt. De doelstellingen van dit hoofdstuk zijn:</p>
<ol style="list-style-type: decimal">
<li>Introductie in de analyse van tijdreeksen</li>
<li>Introductie van prognosetechnieken in het algemeen en de mogelijkheden met Excel</li>
<li>Het opdoen van praktische vaardigheden via taken en oefeningen</li>
</ol>
<p><strong>Wat is een tijdreeks?</strong></p>
<p>Een tijdreeks is een reeks waarnemingen van een variabele gemeten op opeenvolgende tijdstippen of over opeenvolgende periodes. Wanneer de gegevens een bepaald patroon in de tijd vormen, dan kan dit patroon gebruikt worden om een prognose voor een toekomstige waarde te maken.</p>
<div class="tip">
<p>Het kan ook zijn dat de waarde van een variabele afhangt van andere variabelen dan de tijd. Zo zou er een verband kunnen zijn tussen de hoogte van de bloeddruk en de leeftijd. Je hebt dan een onafhankelijke variabele (leeftijd) en een afhankelijke variabele (bloeddruk). Dergelijke verbanden tussen variabelen worden onderzocht met <em>regressie-analyse</em>. Wanneer je de tijd als een onafhankelijke variabele beschouwt, dan kan regressie-analyse ook bij tijdreeksen worden gebruikt.</p>
</div>
<p>De meetgegevens van de variabele bestaan uit herhaalde metingen op vaste tijdstippen zoals elk uur, dag, week, maand, kwartaal, jaar of elke regelmatige periode. De gegevens zijn dus geordend in de tijd en de tijd tussen elke waarneming is constant.</p>
<p>Voorbeelden van tijdreeksen:</p>
<ul>
<li>ziekteverzuim per maand of jaar</li>
<li>omzet per maand</li>
<li>verkopen per kwartaal</li>
<li>verkeersdoden per jaar</li>
<li>…</li>
</ul>
<p>Veel tijdreeksen vertonen een trend (toename of afname) en/of zijn seizoensgebonden, dat wil zeggen variaties die specifiek voor een bepaald tijdsbestek zijn. Zo zal bijvoorbeeld de verkoop van ijs in de zomer hoger zijn dan in de winter.</p>
</div>
<div id="ts-componenten" class="section level2" number="7.2">
<h2>
<span class="header-section-number">7.2</span> Componenten tijdreeks<a class="anchor" aria-label="anchor" href="#ts-componenten"><i class="fas fa-link"></i></a>
</h2>
<p>Een tijdreeksanalyse is de analyse van gegevens die in de loop van een bepaalde periode verzameld zijn. Het is dus een onderzoek naar de samenhang tussen twee variabelen, waarvan de onafhankelijke variabele de tijd is.</p>
<p>Een tijdreeksanalyse begint altijd met het weergeven van de tijdreeks in een grafiek. Op de horizontale as staat altijd de tijd en op de verticale as de te onderzoeken variabele. De grafiek geeft vaak al een eerste beeld van de kenmerken van de tijdreeks.</p>
<div class="workedexample">
<div class="figure" style="text-align: center">
<span id="fig:airpassengers"></span>
<img src="excelanalyse_files/figure-html/airpassengers-1.svg" alt="Tijdreeks van het aantal internationale vliegtuigpassagiers per maand (1949-1960)" width="100%"><p class="caption">
Figuur 7.1: Tijdreeks van het aantal internationale vliegtuigpassagiers per maand (1949-1960)
</p>
</div>
<p>Je ziet hierin onmiddellijk een paar zaken:</p>
<ol style="list-style-type: decimal">
<li>Het aantal passagiers neemt in de loop van de tijd toe.</li>
<li>Er vinden jaarlijks terugkerende patronen plaats: periodiek gedrag.</li>
<li>De variantie lijkt in de tijd toe te nemen: de uitzwaaiers worden groter.</li>
</ol>
</div>
<p>Zaken waar je op moet letten zijn:</p>
<ul>
<li>Is er een <em>trend</em>? Dit houdt in dat de variabele de neiging heeft toe te nemen (continu stijgend) of af te nemen (continu dalend).</li>
<li>Is er <em>seizoensgebondenheid</em>? Dit houdt in dat er een regelmatig terugkerend patroon van pieken en dalen te zien is, gerelateerd aan bepaalde tijdsdelen zoals seizoenen, kwartalen, maanden, weekdagen, enz.</li>
<li>Zijn er <em>uitschieters</em>? Dit zijn waarden die ver verwijderd zijn van de andere waarden.</li>
<li>Is er een <em>lange termijn cyclus</em>? Deze is niet gerelateerd aan de seizoensfactoren.</li>
<li>Is er een <em>constante variantie</em> van de variabele over de tijd of wordt deze groter of kleiner?</li>
<li>Zijn er <em>plotselinge wijzigingen</em> in de grootte of de variantie?</li>
</ul>
<p>Bij een nauwkeuriger analyse van een tijdreeks is het nuttig wanneer je dergelijke zaken apart zou kunnen bekijken. Daarvoor moet je een tijdreeks in de verschillende componenten kunnen splitsen. Bij de meest gebruikte systematiek gaat men er van uit dat een tijdreeks uit de volgende componenten bestaat:</p>
<div class="figure" style="text-align: center">
<span id="fig:ts-componenten"></span>
<div id="htmlwidget-6a6eb478b7e198ca6fef" style="width:100%;height:355.968px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-6a6eb478b7e198ca6fef">{"x":{"diagram":"\n  digraph stat1 {\n    graph[rankdir = TB, bgcolor=transparent]\n    node[shape = box, fontname = Arial]\n    TS [label = \"Tijdreeks\"]\n\n    node[shape = box, width = 0.8, fontsize = 10]\n    T [label = \"Trend (T)\ncomponent\"]\n    S [label = \"Seizoen (S)\ncomponent\"]\n    C [label = \"Cyclische (C)\ncomponent\"]\n    R [label = \"Random (R)\ncomponent\"]\n\n    TS -> {T, S, C, R}\n  }\n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script><p class="caption">
Figuur 7.2: Componenten van een tijdreeks.
</p>
</div>
<div id="ts-comp-trend" class="section level3" number="7.2.1">
<h3>
<span class="header-section-number">7.2.1</span> Component Trend<a class="anchor" aria-label="anchor" href="#ts-comp-trend"><i class="fas fa-link"></i></a>
</h3>
<p>De neiging om over langere tijd te stijgen (positieve trend) of te dalen (negatieve trend). Deze hoeft niet lineair te zijn. Soms wordt alleen naar een trend verwezen als de richting (stijgend of dalen) waarin de veranderingen plaatsvinden.</p>
<div class="workedexample">
<div class="figure" style="text-align: center">
<span id="fig:ap-trend"></span>
<img src="excelanalyse_files/figure-html/ap-trend-1.svg" alt="Trendcomponent aantal internationale vliegtuigpassagiers." width="70%"><p class="caption">
Figuur 7.3: Trendcomponent aantal internationale vliegtuigpassagiers.
</p>
</div>
<p>De trend is nagenoeg lineair.</p>
</div>
</div>
<div id="ts-comp-season" class="section level3" number="7.2.2">
<h3>
<span class="header-section-number">7.2.2</span> Component Seizoen<a class="anchor" aria-label="anchor" href="#ts-comp-season"><i class="fas fa-link"></i></a>
</h3>
<p>Dit zijn regelmatige schommelingen (fluctuaties) per dag/maand/kwartaal (meestal binnen een jaar). Zo zullen ijsverkopen in de zomer hoger zijn dan in de winter. Seizoensgebondenheid betreft altijd een vaste, bekende periode.</p>
<div class="workedexample">
<div class="figure" style="text-align: center">
<span id="fig:ap-season"></span>
<img src="excelanalyse_files/figure-html/ap-season-1.svg" alt="Seizoencomponent aantal internationale vliegtuigpassagiers." width="70%"><p class="caption">
Figuur 7.4: Seizoencomponent aantal internationale vliegtuigpassagiers.
</p>
</div>
<p>De seizoenscomponent lijkt elk jaar laag te beginnen, halverwege te stijgen (zomer?) en dan weer te dalen.</p>
</div>
</div>
<div id="ts-comp-random" class="section level3" number="7.2.3">
<h3>
<span class="header-section-number">7.2.3</span> Component Random<a class="anchor" aria-label="anchor" href="#ts-comp-random"><i class="fas fa-link"></i></a>
</h3>
<p>Dit zijn onregelmatige schommelingen die niet uit een van de eerder genoemde onderdelen verklaard kunnen worden. Ze worden ook wel toevallige invloeden genoemd.</p>
<div class="workedexample">
<div class="figure" style="text-align: center">
<span id="fig:ap-random"></span>
<img src="excelanalyse_files/figure-html/ap-random-1.svg" alt="Randomcomponent aantal internationale vliegtuigpassagiers." width="70%"><p class="caption">
Figuur 7.5: Randomcomponent aantal internationale vliegtuigpassagiers.
</p>
</div>
<p>Het lijkt er op dat deze component niet volledig willekeurig is, omdat er in het midden een stukje zit dat minder variatie heeft dan de rest. Wanneer dat zo is en er dus nog een patroon in deze component zit, dan is de decompositie niet volledig geslaagd.</p>
</div>
</div>
<div id="ts-comp-cyclic" class="section level3" number="7.2.4">
<h3>
<span class="header-section-number">7.2.4</span> Component Cyclisch<a class="anchor" aria-label="anchor" href="#ts-comp-cyclic"><i class="fas fa-link"></i></a>
</h3>
<p>Dit zijn schommelingen (golfbewegingen) over een langere periode, vaak vele jaren, door schommelingen in de conjunctuur. Kenmerkend is ook dat deze periodes geen vaste lengte hebben. In veel gevallen wordt de cyclische component weggelaten of gecombineerd met de trend tot één trendcyclus.</p>
<div class="tip">
<p>De conjunctuur is een samenspel van verschillende factoren of indicatoren. Zie eventueel:</p>
<ul>
<li><a href="https://www.cbs.nl/nl-nl/dossier/dossier-conjunctuur">Dossier Conjunctuur, CBS</a></li>
<li><a href="https://www.cbs.nl/nl-nl/visualisaties/conjunctuurklok">Conjunctuurklok, CBS</a></li>
</ul>
</div>
</div>
<div id="ts-models" class="section level3" number="7.2.5">
<h3>
<span class="header-section-number">7.2.5</span> Modellen<a class="anchor" aria-label="anchor" href="#ts-models"><i class="fas fa-link"></i></a>
</h3>
<p>Er worden twee wiskundige modellen voor tijdreeksen gehanteerd: Additief en Multiplicatief. En het ontleden van de tijdreeks in de afzonderlijke componenten heet <em>decompositie</em> van de tijdreeks.</p>
<p><strong>Additief model</strong></p>
<p>Je kiest hiervoor wanneer de seizoenseffecten in grootte nagenoeg constant blijven.</p>
<p><span class="math inline">\(Y_t = T_t + S_t + R_t\)</span></p>
<ul>
<li>
<span class="math inline">\(Y_t\)</span> - de waargenomen waarde in de tijdreeks op tijdstip <span class="math inline">\(t\)</span>
</li>
<li>
<span class="math inline">\(T_t\)</span> - waarde trend component op tijdstip <span class="math inline">\(t\)</span>
</li>
<li>
<span class="math inline">\(S_t\)</span> - waarde seizoen component op tijdstip <span class="math inline">\(t\)</span>
</li>
<li>
<span class="math inline">\(R_t\)</span> - waarde random component op tijdstip <span class="math inline">\(t\)</span>
</li>
</ul>
<p>Je telt dus gewoon de waarden van de drie componenten op om de waarde in de tijdreeks te krijgen.</p>
<p><strong>Multiplicatief model</strong></p>
<p>Je kiest hiervoor wanneer de seizoenseffecten in grootte toenemen of afnemen.</p>
<p><span class="math inline">\(Y_t = T_t \times S_t \times R_t\)</span></p>
<ul>
<li>
<span class="math inline">\(Y_t\)</span> - de waargenomen waarde in de tijdreeks op tijdstip <span class="math inline">\(t\)</span>
</li>
<li>
<span class="math inline">\(T_t\)</span> - waarde trend component op tijdstip <span class="math inline">\(t\)</span>
</li>
<li>
<span class="math inline">\(S_t\)</span> - seizoenindex op tijdstip <span class="math inline">\(t\)</span>
</li>
<li>
<span class="math inline">\(R_t\)</span> - randomindex op tijdstip <span class="math inline">\(t\)</span>
</li>
</ul>
<p>De trend wordt gemeten in eenheden van de variabele in de tijdreeks. De seizoenscomponenten en onregelmatige componenten worden echter relatief gemeten, waarbij waarden boven de 1,00 duiden op effecten boven de trend en waarden onder 1,00 op effecten onder de trend. Om de tijdreekswaarde te krijgen worden deze drie componenten met elkaar vermenigvuldigd. Veel zakelijke en economische tijdreeksen volgen dit patroon.</p>
<p>In figuur <a href="timeseries.html#fig:airpassengers">7.1</a> zie je de seizoenseffecten steeds groter worden, hier past dus een multiplicatief model bij.</p>
<div class="tip">
<p>Een multiplicatieve tijdreeks kan via de logaritme functie omgezet worden in een additieve tijdreeks:</p>
<p><span class="math inline">\(log(T*S*C*R) = log(T) + log(S) + log(C) + log(R)\)</span></p>
</div>
<p>Er zijn verschillende methodes voor het bepalen van de afzonderlijke componenten. Het gewogen gemiddelde wordt meestal gebruikt om te corrigeren voor de seizoensinvloed. Hierna wordt de trend bepaald voor de seizoengecorrigeerde reeks. Wat er dan nog overblijft is de randomcomponent. Het uitvoeren van een decompositie valt buiten het bestek van dit studieboek.</p>
</div>
<div id="oefening-australische-bierproductie" class="section level3" number="7.2.6">
<h3>
<span class="header-section-number">7.2.6</span> Oefening: Australische bierproductie<a class="anchor" aria-label="anchor" href="#oefening-australische-bierproductie"><i class="fas fa-link"></i></a>
</h3>
<p>Als voorbeeld van een tijdreeks wordt de bierproductie (in megaliters) in Australie voor de jaren 1956-1973 bekeken en geanalyseerd.</p>
<ol style="list-style-type: decimal">
<li><p>Download het hulpbestand <a href="data/ausbeer56-73.xlsx">ausbeer56-73.xlsx</a> en open het daarna.</p></li>
<li><p>Selecteer een cel in de tabel en kies dan <em>tab Invoegen &gt; Draaigrafiek (groep Grafieken) &gt; Draaigrafiek &gt; OK</em>. Op een nieuw werkblad wordt een lege draaitabel aangemaakt.</p></li>
<li><p>Voeg het veld <code>Volume</code> toe aan het gebied <em>Waarden</em> en het veld <code>Datum</code> aan het gebied <em>As (categorieën)</em>. Naast het veld <code>Datum</code> worden ook de velden <code>Jaren</code> en <code>Kwartalen</code> aangemaakt.</p></li>
<li><p>Wijzig het grafiektype in <em>Lijn met markeringen</em>.</p></li>
<li><p>Selecteer in de draaitabel een willekeurig jaar. Daarna Rechter muisknop en kies uit het snelmenu <em>Uit- en samenvouwen &gt; Gehele veld uitbreiden</em>. Zowel in de draaitabel als draaigrafiek worden de jaren uitgesplitst in kwartalen. In principe is de tijdreeks nu zichtbaar. Echter de layout kan nog verbeterd worden.</p></li>
<li>
<p>Breng de volgende wijzigingen in de lay-out aan:</p>
<ul>
<li>Verwijder het veld Datum uit het gebied As in de lijst met Draaitabelvelden.</li>
<li>Wijzig in de draaitabel in de cel rechtsboven de tekst “Som van Volume” in “Bierproductie”. Hierdoor wijzigt ook de tekst linksboven in de draaigrafiek.</li>
<li>Schaal de Y-as van 200 tot 600 met stappen van 50.</li>
<li>Voeg een titel aan de Y-as toe.</li>
<li>Verwijder de legenda en grafiektitel.</li>
<li>Maak de lijn iets dunner en geef de markeringspunten een andere kleur dan de lijn.</li>
<li>Pas eventueel de afmetingen aan.</li>
</ul>
</li>
</ol>
<p>Het resultaat zie je in figuur <a href="timeseries.html#fig:ts-beer1">7.6</a></p>
<div class="figure" style="text-align: center">
<span id="fig:ts-beer1"></span>
<img src="images/timeseries/ts_beer1.png" alt="Australische bierproductie (megaliters) per kwartaal." width="100%"><p class="caption">
Figuur 7.6: Australische bierproductie (megaliters) per kwartaal.
</p>
</div>
<p>In de grafiek zie je de volgende kenmerken:</p>
<ul>
<li>Er is een opwaartse trend, mogelijk geen rechte lijn maar iets gebogen.</li>
<li>Er is een sterke seizoensgebondenheid te zien door de regelmatige pieken en dalen gerelateerd aan de verschillende kwartalen. De top ligt steeds bij kwartaal 4, de dalen bij de kwartalen 2 en 3 en de waarden voor kwartaal 1 liggen tussen piek en dal.</li>
<li>Er zijn geen uitschieters.</li>
<li>Er is geen lange termijn cyclus.</li>
<li>De variantie in de waarden lijkt iets toe te nemen in de tijd.</li>
</ul>
<p>Om een beter beeld te krijgen van de seizoensgebondenheid wordt de grafiek gewijzigd zodat de gegevens voor elk jaar worden uitgezet tegen de afzonderlijke kwartalen.</p>
<ol start="7" style="list-style-type: decimal">
<li><p>Verplaats in de lijst met draaitabelvelden het veld <code>Jaren</code> van het gebied <em>As</em> naar het gebied <em>Legenda</em>.</p></li>
<li>
<p>In de draaigrafiek:</p>
<ul>
<li>Voeg een legenda toe aan de bovenkant.</li>
<li>Rechter muisklik op de legenda en kies dan uit het snelmenu legenda opmakenDeselecteer: De legenda weergeven zonder dat deze de grafiek overlapt.</li>
<li>Rechterhuisklik op de legendaknop en kies Legendaveldknopppen verbergen in de grafiek</li>
</ul>
</li>
</ol>
<p>In de nu ontstane grafiek <a href="timeseries.html#fig:ts-beer2">7.7</a> is de seizoensgebondenheid duidelijk waar te nemen.</p>
<div class="figure" style="text-align: center">
<span id="fig:ts-beer2"></span>
<img src="images/timeseries/ts_beer2.png" alt="Jaarlijkse Australische bierproductie (megaliters) per kwartaal." width="100%"><p class="caption">
Figuur 7.7: Jaarlijkse Australische bierproductie (megaliters) per kwartaal.
</p>
</div>
<p>Om het gedrag per kwartaal te bestuderen worden de gegevens voor elk kwartaal uitgezet tegen de jaren.</p>
<ol start="9" style="list-style-type: decimal">
<li>Verwissel de velden <code>Jaren</code> en <code>Kwartalen</code> in de lijst met draaitabelvelden, dan staat <code>Jaren</code> in het gebied <em>As</em> en <code>Kwartalen</code> in het gebied <em>Legenda</em>.</li>
</ol>
<div class="figure" style="text-align: center">
<span id="fig:ts-beer3"></span>
<img src="images/timeseries/ts_beer3.png" alt="Jaarlijkse Australische bierproductie (megaliters) per kwartaal." width="100%"><p class="caption">
Figuur 7.8: Jaarlijkse Australische bierproductie (megaliters) per kwartaal.
</p>
</div>
<p>Nu kun je goed zien dat de eerder waargenomen stijgende trend voor elk kwartaal geldt.</p>
</div>
</div>
<div id="ts-ma" class="section level2" number="7.3">
<h2>
<span class="header-section-number">7.3</span> Voortschrijdend gemiddelde<a class="anchor" aria-label="anchor" href="#ts-ma"><i class="fas fa-link"></i></a>
</h2>
<p>Het voortschrijdend gemiddelde (Moving Average, MA) is een gemiddelde van een vast aantal opeenvolgende waarnemingen. De verzameling waarnemingen waarover het gemiddelde berekend wordt, schuift mee in de tijd.
Het aantal van deze waarnemingen wordt ook wel de <em>breedte</em> genoemd van een venster dat als het ware over de waarnemingen wordt gelegd. Door het venster steeds één periode op te schuiven ontstaat een reeks van gemiddelden. Deze reeks van gemiddelden geeft een gladder (smooth) verloop van de tijdreeks weer, doordat seizoensinvloeden en ruis (random component) vereffent worden, waardoor het verloop op de langere termijn (de trend) getoond wordt.
Het doel van deze vereffeningsmethode is dan ook om seizoensinvloeden en ruis te verwijderen. Daarom is de vensterbreedte meestal ook gelijk aan de lengte van het seizoen.
Het voortschrijdend gemiddelde is gevoelig voor de breedte van het venster. Bij een smaller venster wordt er sneller gereageerd op veranderingen in de trend.</p>
<p>Er zijn twee methodes om het voortschrijdend gemiddelde te berekenen.</p>
<p><strong>Gecentreerd (Middeling rond <span class="math inline">\(t_n\)</span>)</strong></p>
<p>Het gemiddelde wordt hier berekend voor een tijdstip <span class="math inline">\(t_n\)</span> dat in het midden van het venster ligt. Er wordt dus het gemiddelde berekend van waarden rondom dat tijdstip.
Voor een 5-punts voortschrijdend gemiddelde op tijdstip <span class="math inline">\(t_n\)</span> bereken je dan het gemiddelde van de waarden op de tijdstippen <span class="math inline">\(t_{n-2}\)</span>, <span class="math inline">\(t_{n-1}\)</span>, <span class="math inline">\(t_n\)</span>, <span class="math inline">\(t_{n+1}\)</span>, <span class="math inline">\(t_{n+2}\)</span>. Het tijdstip <span class="math inline">\(t_n\)</span> ligt dus in het midden van het venster. Je kunt dan geen voortschrijdend gemiddelde berekenen voor de eerste twee en de laatste twee tijdstippen in de tijdreeks.</p>
<p>De middeling wordt dan altijd gebaseerd op een oneven aantal meetwaarden, zodat het interval symmetrisch rond <span class="math inline">\(t_n\)</span> ligt.</p>
<p>Omdat bij deze methode ook altijd waarden na tijdstip <span class="math inline">\(t_n\)</span> bekend moeten zijn, kun je deze methode niet gebruiken worden voor het maken van prognoses. De methode is wel zeer geschikt om tijdreeksen te visualiseren en seizoensinvloeden en ruis te onderdrukken.</p>
<p><strong>Achterlopend (Middeling over voorgaande periode)</strong></p>
<p>Hier is het tijdstip <span class="math inline">\(t_n\)</span> waarvoor het voortschrijdend gemiddelde bepaald wordt de laatste periode in het venster. Het gemiddelde wordt dus berekend uit waarden op tijdstip <span class="math inline">\(t_n\)</span> en daarvoor.
Voor een voortschrijdend gemiddelde van drie maanden wordt de waarde voor de maand maart het gemiddelde van de waarden voor januari,februari en maart. Het volgende voortschrijdend gemiddelde is dat voor de maand april, dat het gemiddelde van februari, maart en april is. Dat gaat zo door tot je bij de laatste waarde uit de reeks bent. Voor de eerste twee maanden kun je geen voortschrijdend gemiddelde berekenen.
Zou je een halfjaars voortschrijdend gemiddelde gebruiken, dan kan dat pas voor het eerst voor de maand juni, dat dan het gemiddelde wordt van de maanden januari t/m juni)</p>
<p>Omdat je met deze methode ook voor het laatste tijdstip het voortschrijdend gemiddelde kunt berekenen kan deze methode ook gebruikt worden bij het maken van prognoses. Voor visualisatie van de tijdreeks is deze methode watminder geschikt omdat het voortschrijdend gemiddelde achter loopt en de trend minder zichtbaar wordt.</p>
<p>In de financiële wereld, vooral bij de analyse van aandelenkoersen, wordt voornamelijk met deze methode gewerkt.</p>
<div class="tip">
<p>Er zijn ook varianten met weegfactoren zodat je een <strong>gewogen voortschrijdend gemiddelde</strong> krijgt.</p>
</div>
<p><strong>Voorbeeld</strong></p>
<p>Een eenvoudig voorbeeld van beide soorten zie je in de volgende figuur.</p>
<div class="inline-figure"><img src="images/timeseries/ma-verkoop.png"></div>
<!-- In repository tijdreeksen staan nog meer voorbeelden o.a. voor AirPassengers. -->
<div id="ts-ma-calc" class="section level3" number="7.3.1">
<h3>
<span class="header-section-number">7.3.1</span> Berekening<a class="anchor" aria-label="anchor" href="#ts-ma-calc"><i class="fas fa-link"></i></a>
</h3>
<p>In Excel kun je op drie manieren het voortschrijdend gemiddelde berekenen.</p>
<ol style="list-style-type: decimal">
<li><p>Met de werkblad functie <code>=GEMIDDELDE()</code>. Je kunt dan zelf kiezen welke van de hiervoor genoemde twee methodes je wilt gebruiken.</p></li>
<li><p>Via een trendlijn aan een bestaande grafiek toevoegen. Deze gebruikt de achterlopende methode (middeling over voorgaande periode). Je kunt de breedte van het venster instellen. Er wordt een lijn in de grafiek geplaatst die de voortschrijdende gemiddeldes volgt. De waarden van de gemiddeldes zelf worden niet getoond. Voor de werkwijze en een voorbeeld zie bijlage <a href="app-excel-trendlijnen.html#app-excel-trendlijnen">C</a>.</p></li>
<li><p>Via <em>Gegevens &gt; Gegevensanalyse &gt; Zwevend Gemiddelde</em>. Ook hier wordt de achterlopende methode (middeling over voorgaande periode) gebruikt. De gemiddeldes worden in het werkblad geplaatst en je kunt in het dialoogscherm, zie figuur <a href="timeseries.html#fig:dialog-ma">7.9</a>, aangeven dat je een grafiek en eventueel ook de standaardfouten wilt zien. De breedte van het venster specificeer je in het vak voor interval.</p></li>
</ol>
<div class="workedexample">
<p><strong>Autoverkopen</strong></p>
<p>In het bestand <a href="data/autoverkoop.xlsx">autoverkoop.xlsx</a> staan de autoverkopen per kwartaal over vier jaar. De verkopen worden beïnvloed door het kwartaal. Om de trend te bestuderen wordt daarom een voortschrijdend gemiddelde gemaakt met een vensterbreedte van 4.</p>
<p>Download het bestand, open het en kies <em>Gegevens &gt; Gegevensanalyse &gt; Zwevend Gemiddelde</em></p>
<div class="figure" style="text-align: center">
<span id="fig:dialog-ma"></span>
<img src="images/timeseries/zwevend-gemiddelde.png" alt="Dialoogscherm Zwevend Gemiddelde" width="50%"><p class="caption">
Figuur 7.9: Dialoogscherm Zwevend Gemiddelde
</p>
</div>
<p>Specificeer het volgende.</p>
<ul>
<li>
<em>Invoerbereik</em>: C2:C17</li>
<li>
<em>Interval</em>: 4</li>
<li>
<em>Uitvoerbereik</em>: D2</li>
<li>
<em>Grafiek maken</em>: aanvinken</li>
</ul>
<p>In het werkblad verschijnen de berekende gemiddeldes:</p>
<div class="figure" style="text-align: center">
<span id="fig:autoverkoop-ma-data"></span>
<img src="images/timeseries/autoverkoop-ma-data.png" alt="Berekende voortschrijdend gemiddeldes." width="40%"><p class="caption">
Figuur 7.10: Berekende voortschrijdend gemiddeldes.
</p>
</div>
<p>En een lijngrafiek met de data en een voortschrijdend gemiddelde:</p>
<div class="figure" style="text-align: center">
<span id="fig:autoverkoop-ma-origineel"></span>
<img src="images/timeseries/autoverkoop-ma-origineel.png" alt="Standaardgrafiek voortschrijdend gemiddeldes." width="70%"><p class="caption">
Figuur 7.11: Standaardgrafiek voortschrijdend gemiddeldes.
</p>
</div>
<p>De seizoensafhankelijkheid is duidelijk zichtbaar. Het voortschrijdend gemiddelde verwijdert deze afhankelijkheid en de ruis. De overblijvende trend is nagenoeg lineair en licht stijgend.</p>
<p>Voor een eerste indruk is de kwaliteit van deze grafiek voldoende. Voor publicatiedoeleinden moet je wel wat verbeteringen aanbrengen. Corrigeer de teksten in de grafiektitel en de titel langs de Y-as. Breng lichte horizontale rasterlijnen aan. Wijzig de labels langs de X-as en de legendatekst als volgt.</p>
<p>Selecteer de gegevensreeks in de grafiek. dan <em>Rechter muisklik &gt; Gegevens selecteren</em>. Kies <em>Horizontale aslabels &gt; Bewerken</em> en geef als <em>Aslabelbereik</em> op <code>A2:B17</code> en <em>OK</em>. Kies <em>Legendagegevens Voorspelling &gt; Bewerken</em> en wijzig de reeksnaam in ‘Voortschrijdend gemiddelde’. Het resultaat is in figuur <a href="timeseries.html#fig:autoverkoop-ma-aangepast">7.12</a> te zien.</p>
<div class="figure" style="text-align: center">
<span id="fig:autoverkoop-ma-aangepast"></span>
<img src="images/timeseries/autoverkoop-ma-aangepast.png" alt="Aangepaste grafiek voortschrijdend gemiddeldes." width="70%"><p class="caption">
Figuur 7.12: Aangepaste grafiek voortschrijdend gemiddeldes.
</p>
</div>
</div>
</div>
</div>
<div id="opg-timeseries" class="section level2" number="7.4">
<h2>
<span class="header-section-number">7.4</span> Opgaven<a class="anchor" aria-label="anchor" href="#opg-timeseries"><i class="fas fa-link"></i></a>
</h2>
<div class="sectionexercise">
<ol style="list-style-type: decimal">
<li>
<p><strong>Inkomsten uit advertenties</strong></p>
<p>In het hulpbestand <a href="data/advertenties.xlsx">advertenties.xlsx</a> staan de inkomsten uit advertenties van een tweewekelijks verschijnend huis-aan-huisblad.</p>
<ol style="list-style-type: lower-alpha">
<li>Maak een grafiek waarin de inkomsten tegen het weeknummer zijn uitgezet.</li>
<li>Voeg een polynoom trendlijn toe. Experimenteer met een polynoom van de 2e, 3e en 4e graad. Verzamel voor elk van deze trendlijnen de R-kwadraat waarde. Maak een keuze voor de meest geschikte trendlijn.</li>
</ol>
</li>
</ol>
</div>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="linregressie.html"><span class="header-section-number">6</span> Samenhang en lineaire regressie</a></div>
<div class="next"><a href="prognoses.html"><span class="header-section-number">8</span> Prognoses</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>Op deze pagina</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#timeseries"><span class="header-section-number">7</span> Tijdreeksen</a></li>
<li><a class="nav-link" href="#ts-intro"><span class="header-section-number">7.1</span> Introductie</a></li>
<li>
<a class="nav-link" href="#ts-componenten"><span class="header-section-number">7.2</span> Componenten tijdreeks</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#ts-comp-trend"><span class="header-section-number">7.2.1</span> Component Trend</a></li>
<li><a class="nav-link" href="#ts-comp-season"><span class="header-section-number">7.2.2</span> Component Seizoen</a></li>
<li><a class="nav-link" href="#ts-comp-random"><span class="header-section-number">7.2.3</span> Component Random</a></li>
<li><a class="nav-link" href="#ts-comp-cyclic"><span class="header-section-number">7.2.4</span> Component Cyclisch</a></li>
<li><a class="nav-link" href="#ts-models"><span class="header-section-number">7.2.5</span> Modellen</a></li>
<li><a class="nav-link" href="#oefening-australische-bierproductie"><span class="header-section-number">7.2.6</span> Oefening: Australische bierproductie</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#ts-ma"><span class="header-section-number">7.3</span> Voortschrijdend gemiddelde</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#ts-ma-calc"><span class="header-section-number">7.3.1</span> Berekening</a></li></ul>
</li>
<li><a class="nav-link" href="#opg-timeseries"><span class="header-section-number">7.4</span> Opgaven</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Excel Data Analyse</strong>" is geschreven door  Ben Welman. Laatste productiedatum 24 maart 2021.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>Dit boek is gemaakt met R package  <a class="text-light" href="https://bookdown.org">bookdown</a> .</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
